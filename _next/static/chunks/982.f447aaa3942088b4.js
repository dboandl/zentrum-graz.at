(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[982],{5470:function(t,e,n){var r;r=function(){function t(t){function e(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function n(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}var r,o=e(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(t)&&/android/i.test(t),a=/nexus\s*[0-6]\s*/i.test(t),h=!a&&/nexus\s*[0-9]+/i.test(t),u=/CrOS/.test(t),c=/silk/i.test(t),l=/sailfish/i.test(t),f=/tizen/i.test(t),p=/(web|hpw)(o|0)s/i.test(t),d=/windows phone/i.test(t),v=(/SamsungBrowser/i.test(t),!d&&/windows/i.test(t)),m=!o&&!c&&/macintosh/i.test(t),_=!s&&!l&&!f&&!p&&/linux/i.test(t),y=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),g=e(/version\/(\d+(\.\d+)?)/i),M=/tablet/i.test(t)&&!/tablet pc/i.test(t),w=!M&&/[^-]mobi/i.test(t),x=/xbox/i.test(t);/opera/i.test(t)?r={name:"Opera",opera:!0,version:g||e(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?r={name:"Opera",opera:!0,version:e(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||g}:/SamsungBrowser/i.test(t)?r={name:"Samsung Internet for Android",samsungBrowser:!0,version:g||e(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(t)?r={name:"NAVER Whale browser",whale:!0,version:e(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(t)?r={name:"MZ Browser",mzbrowser:!0,version:e(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(t)?r={name:"Opera Coast",coast:!0,version:g||e(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(t)?r={name:"Focus",focus:!0,version:e(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(t)?r={name:"Yandex Browser",yandexbrowser:!0,version:g||e(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?r={name:"UC Browser",ucbrowser:!0,version:e(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?r={name:"Maxthon",maxthon:!0,version:e(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?r={name:"Epiphany",epiphany:!0,version:e(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?r={name:"Puffin",puffin:!0,version:e(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?r={name:"Sleipnir",sleipnir:!0,version:e(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?r={name:"K-Meleon",kMeleon:!0,version:e(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:d?(r={name:"Windows Phone",osname:"Windows Phone",windowsphone:!0},y?(r.msedge=!0,r.version=y):(r.msie=!0,r.version=e(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?r={name:"Internet Explorer",msie:!0,version:e(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:u?r={name:"Chrome",osname:"Chrome OS",chromeos:!0,chromeBook:!0,chrome:!0,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?r={name:"Microsoft Edge",msedge:!0,version:y}:/vivaldi/i.test(t)?r={name:"Vivaldi",vivaldi:!0,version:e(/vivaldi\/(\d+(\.\d+)?)/i)||g}:l?r={name:"Sailfish",osname:"Sailfish OS",sailfish:!0,version:e(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?r={name:"SeaMonkey",seamonkey:!0,version:e(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(r={name:"Firefox",firefox:!0,version:e(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(r.firefoxos=!0,r.osname="Firefox OS")):c?r={name:"Amazon Silk",silk:!0,version:e(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?r={name:"PhantomJS",phantom:!0,version:e(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?r={name:"SlimerJS",slimer:!0,version:e(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?r={name:"BlackBerry",osname:"BlackBerry OS",blackberry:!0,version:g||e(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:p?(r={name:"WebOS",osname:"WebOS",webos:!0,version:g||e(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(r.touchpad=!0)):/bada/i.test(t)?r={name:"Bada",osname:"Bada",bada:!0,version:e(/dolfin\/(\d+(\.\d+)?)/i)}:f?r={name:"Tizen",osname:"Tizen",tizen:!0,version:e(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||g}:/qupzilla/i.test(t)?r={name:"QupZilla",qupzilla:!0,version:e(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||g}:/chromium/i.test(t)?r={name:"Chromium",chromium:!0,version:e(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||g}:/chrome|crios|crmo/i.test(t)?r={name:"Chrome",chrome:!0,version:e(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?r={name:"Android",version:g}:/safari|applewebkit/i.test(t)?(r={name:"Safari",safari:!0},g&&(r.version=g)):o?(r={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},g&&(r.version=g)):r=/googlebot/i.test(t)?{name:"Googlebot",googlebot:!0,version:e(/googlebot\/(\d+(\.\d+))/i)||g}:{name:e(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!r.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(r.name=r.name||"Blink",r.blink=!0):(r.name=r.name||"Webkit",r.webkit=!0),!r.version&&g&&(r.version=g)):!r.opera&&/gecko\//i.test(t)&&(r.name=r.name||"Gecko",r.gecko=!0,r.version=r.version||e(/gecko\/(\d+(\.\d+)?)/i)),!r.windowsphone&&(s||r.silk)?(r.android=!0,r.osname="Android"):!r.windowsphone&&o?(r[o]=!0,r.ios=!0,r.osname="iOS"):m?(r.mac=!0,r.osname="macOS"):x?(r.xbox=!0,r.osname="Xbox"):v?(r.windows=!0,r.osname="Windows"):_&&(r.linux=!0,r.osname="Linux");var b="";r.windows?b=function(t){switch(t){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(e(/Windows ((NT|XP)( \d\d?.\d)?)/i)):r.windowsphone?b=e(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):r.mac?b=(b=e(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):o?b=(b=e(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?b=e(/android[ \/-](\d+(\.\d+)*)/i):r.webos?b=e(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):r.blackberry?b=e(/rim\stablet\sos\s(\d+(\.\d+)*)/i):r.bada?b=e(/bada\/(\d+(\.\d+)*)/i):r.tizen&&(b=e(/tizen[\/\s](\d+(\.\d+)*)/i)),b&&(r.osversion=b);var E=!r.windows&&b.split(".")[0];return M||h||"ipad"==o||s&&(3==E||E>=4&&!w)||r.silk?r.tablet=!0:(w||"iphone"==o||"ipod"==o||s||a||r.blackberry||r.webos||r.bada)&&(r.mobile=!0),r.msedge||r.msie&&r.version>=10||r.yandexbrowser&&r.version>=15||r.vivaldi&&r.version>=1||r.chrome&&r.version>=20||r.samsungBrowser&&r.version>=4||r.whale&&1===i([r.version,"1.0"])||r.mzbrowser&&1===i([r.version,"6.0"])||r.focus&&1===i([r.version,"1.0"])||r.firefox&&r.version>=20||r.safari&&r.version>=6||r.opera&&r.version>=10||r.ios&&r.osversion&&r.osversion.split(".")[0]>=6||r.blackberry&&r.version>=10.1||r.chromium&&r.version>=20?r.a=!0:r.msie&&r.version<10||r.chrome&&r.version<20||r.firefox&&r.version<20||r.safari&&r.version<6||r.opera&&r.version<10||r.ios&&r.osversion&&r.osversion.split(".")[0]<6||r.chromium&&r.version<20?r.c=!0:r.x=!0,r}var e=t("undefined"!=typeof navigator&&navigator.userAgent||"");function n(t){return t.split(".").length}function r(t,e){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n++)r.push(e(t[n]));return r}function i(t){for(var e=Math.max(n(t[0]),n(t[1])),i=r(t,function(t){var i=e-n(t);return r((t+=Array(i+1).join(".0")).split("."),function(t){return Array(20-t.length).join("0")+t}).reverse()});--e>=0;){if(i[0][e]>i[1][e])return 1;if(i[0][e]!==i[1][e])return -1;if(0===e)return 0}}function o(n,r,o){var s=e;"string"==typeof r&&(o=r,r=void 0),void 0===r&&(r=!1),o&&(s=t(o));var a=""+s.version;for(var h in n)if(n.hasOwnProperty(h)&&s[h]){if("string"!=typeof n[h])throw Error("Browser version in the minVersion map should be a string: "+h+": "+String(n));return 0>i([a,n[h]])}return r}return e.test=function(t){for(var n=0;n<t.length;++n){var r=t[n];if("string"==typeof r&&r in e)return!0}return!1},e.isUnsupportedBrowser=o,e.compareVersions=i,e.check=function(t,e,n){return!o(t,e,n)},e._detect=t,e.detect=t,e},t.exports?t.exports=r():n.amdD("bowser",r)},5994:function(t,e,n){"use strict";n.r(e),n.d(e,{glMatrix:function(){return f},mat2:function(){return p},mat2d:function(){return d},mat3:function(){return v},mat4:function(){return m},quat:function(){return g},quat2:function(){return M},vec2:function(){return w},vec3:function(){return _},vec4:function(){return y}});var r,i,o,s,a,h,u,c,l,f={};n.r(f),n.d(f,{ARRAY_TYPE:function(){return b},EPSILON:function(){return x},RANDOM:function(){return E},equals:function(){return S},setMatrixArrayType:function(){return T},toRadian:function(){return C}});var p={};n.r(p),n.d(p,{LDU:function(){return W},add:function(){return U},adjoint:function(){return O},clone:function(){return P},copy:function(){return z},create:function(){return A},determinant:function(){return F},equals:function(){return Z},exactEquals:function(){return K},frob:function(){return j},fromRotation:function(){return B},fromScaling:function(){return N},fromValues:function(){return I},identity:function(){return R},invert:function(){return k},mul:function(){return $},multiply:function(){return q},multiplyScalar:function(){return Q},multiplyScalarAndAdd:function(){return J},rotate:function(){return V},scale:function(){return X},set:function(){return D},str:function(){return Y},sub:function(){return tt},subtract:function(){return G},transpose:function(){return H}});var d={};n.r(d),n.d(d,{add:function(){return ty},clone:function(){return tn},copy:function(){return tr},create:function(){return te},determinant:function(){return th},equals:function(){return tb},exactEquals:function(){return tx},frob:function(){return t_},fromRotation:function(){return tp},fromScaling:function(){return td},fromTranslation:function(){return tv},fromValues:function(){return to},identity:function(){return ti},invert:function(){return ta},mul:function(){return tE},multiply:function(){return tu},multiplyScalar:function(){return tM},multiplyScalarAndAdd:function(){return tw},rotate:function(){return tc},scale:function(){return tl},set:function(){return ts},str:function(){return tm},sub:function(){return tT},subtract:function(){return tg},translate:function(){return tf}});var v={};n.r(v),n.d(v,{add:function(){return tZ},adjoint:function(){return tH},clone:function(){return tS},copy:function(){return tA},create:function(){return tL},determinant:function(){return tk},equals:function(){return t0},exactEquals:function(){return t1},frob:function(){return tK},fromMat2d:function(){return tY},fromMat4:function(){return tC},fromQuat:function(){return tj},fromRotation:function(){return tB},fromScaling:function(){return tN},fromTranslation:function(){return tX},fromValues:function(){return tP},identity:function(){return tR},invert:function(){return tD},mul:function(){return t2},multiply:function(){return tO},multiplyScalar:function(){return tJ},multiplyScalarAndAdd:function(){return t$},normalFromMat4:function(){return tW},projection:function(){return tU},rotate:function(){return tq},scale:function(){return tV},set:function(){return tz},str:function(){return tG},sub:function(){return t3},subtract:function(){return tQ},translate:function(){return tF},transpose:function(){return tI}});var m={};n.r(m),n.d(m,{add:function(){return eI},adjoint:function(){return en},clone:function(){return t4},copy:function(){return t6},create:function(){return t5},determinant:function(){return er},equals:function(){return eF},exactEquals:function(){return eO},frob:function(){return eR},fromQuat:function(){return eE},fromQuat2:function(){return ey},fromRotation:function(){return ep},fromRotationTranslation:function(){return e_},fromRotationTranslationScale:function(){return ex},fromRotationTranslationScaleOrigin:function(){return eb},fromScaling:function(){return ef},fromTranslation:function(){return el},fromValues:function(){return t8},fromXRotation:function(){return ed},fromYRotation:function(){return ev},fromZRotation:function(){return em},frustum:function(){return eT},getRotation:function(){return ew},getScaling:function(){return eM},getTranslation:function(){return eg},identity:function(){return t7},invert:function(){return ee},lookAt:function(){return eA},mul:function(){return eq},multiply:function(){return ei},multiplyScalar:function(){return eH},multiplyScalarAndAdd:function(){return ek},ortho:function(){return eS},perspective:function(){return eL},perspectiveFromFieldOfView:function(){return eC},rotate:function(){return ea},rotateX:function(){return eh},rotateY:function(){return eu},rotateZ:function(){return ec},scale:function(){return es},set:function(){return t9},str:function(){return ez},sub:function(){return eV},subtract:function(){return eD},targetTo:function(){return eP},translate:function(){return eo},transpose:function(){return et}});var _={};n.r(_),n.d(_,{add:function(){return eU},angle:function(){return nf},bezier:function(){return ni},ceil:function(){return eQ},clone:function(){return eB},copy:function(){return ej},create:function(){return eX},cross:function(){return ne},dist:function(){return nM},distance:function(){return e5},div:function(){return ng},divide:function(){return eZ},dot:function(){return nt},equals:function(){return nm},exactEquals:function(){return nv},floor:function(){return eJ},forEach:function(){return nE},fromValues:function(){return eY},hermite:function(){return nr},inverse:function(){return e9},len:function(){return nx},length:function(){return eN},lerp:function(){return nn},max:function(){return e1},min:function(){return e$},mul:function(){return ny},multiply:function(){return eK},negate:function(){return e8},normalize:function(){return e7},random:function(){return no},rotateX:function(){return nu},rotateY:function(){return nc},rotateZ:function(){return nl},round:function(){return e0},scale:function(){return e2},scaleAndAdd:function(){return e3},set:function(){return eW},sqrDist:function(){return nw},sqrLen:function(){return nb},squaredDistance:function(){return e4},squaredLength:function(){return e6},str:function(){return nd},sub:function(){return n_},subtract:function(){return eG},transformMat3:function(){return na},transformMat4:function(){return ns},transformQuat:function(){return nh},zero:function(){return np}});var y={};n.r(y),n.d(y,{add:function(){return nP},ceil:function(){return nD},clone:function(){return nL},copy:function(){return nS},create:function(){return nT},cross:function(){return nK},dist:function(){return n8},distance:function(){return nX},div:function(){return n6},divide:function(){return nI},dot:function(){return nG},equals:function(){return n3},exactEquals:function(){return n2},floor:function(){return nH},forEach:function(){return re},fromValues:function(){return nC},inverse:function(){return nW},len:function(){return n7},length:function(){return nN},lerp:function(){return nZ},max:function(){return nO},min:function(){return nk},mul:function(){return n4},multiply:function(){return nR},negate:function(){return nj},normalize:function(){return nU},random:function(){return nQ},round:function(){return nF},scale:function(){return nq},scaleAndAdd:function(){return nV},set:function(){return nA},sqrDist:function(){return n9},sqrLen:function(){return rt},squaredDistance:function(){return nB},squaredLength:function(){return nY},str:function(){return n0},sub:function(){return n5},subtract:function(){return nz},transformMat4:function(){return nJ},transformQuat:function(){return n$},zero:function(){return n1}});var g={};n.r(g),n.d(g,{add:function(){return rL},calculateW:function(){return rl},clone:function(){return rx},conjugate:function(){return ry},copy:function(){return rE},create:function(){return rn},dot:function(){return rA},equals:function(){return rO},exactEquals:function(){return rk},exp:function(){return rf},fromEuler:function(){return rM},fromMat3:function(){return rg},fromValues:function(){return rb},getAngle:function(){return rs},getAxisAngle:function(){return ro},identity:function(){return rr},invert:function(){return r_},len:function(){return rR},length:function(){return rz},lerp:function(){return rP},ln:function(){return rp},mul:function(){return rC},multiply:function(){return ra},normalize:function(){return rH},pow:function(){return rd},random:function(){return rm},rotateX:function(){return rh},rotateY:function(){return ru},rotateZ:function(){return rc},rotationTo:function(){return rF},scale:function(){return rS},set:function(){return rT},setAxes:function(){return rV},setAxisAngle:function(){return ri},slerp:function(){return rv},sqlerp:function(){return rq},sqrLen:function(){return rD},squaredLength:function(){return rI},str:function(){return rw}});var M={};n.r(M),n.d(M,{add:function(){return it},clone:function(){return rB},conjugate:function(){return ih},copy:function(){return rK},create:function(){return rX},dot:function(){return io},equals:function(){return i_},exactEquals:function(){return im},fromMat4:function(){return rG},fromRotation:function(){return rU},fromRotationTranslation:function(){return rj},fromRotationTranslationValues:function(){return rY},fromTranslation:function(){return rW},fromValues:function(){return rN},getDual:function(){return r$},getReal:function(){return rJ},getTranslation:function(){return r2},identity:function(){return rZ},invert:function(){return ia},len:function(){return ic},length:function(){return iu},lerp:function(){return is},mul:function(){return ir},multiply:function(){return ie},normalize:function(){return id},rotateAroundAxis:function(){return r7},rotateByQuatAppend:function(){return r8},rotateByQuatPrepend:function(){return r9},rotateX:function(){return r5},rotateY:function(){return r4},rotateZ:function(){return r6},scale:function(){return ii},set:function(){return rQ},setDual:function(){return r0},setReal:function(){return r1},sqrLen:function(){return ip},squaredLength:function(){return il},str:function(){return iv},translate:function(){return r3}});var w={};n.r(w),n.d(w,{add:function(){return ib},angle:function(){return iZ},ceil:function(){return iC},clone:function(){return ig},copy:function(){return iw},create:function(){return iy},cross:function(){return iB},dist:function(){return i4},distance:function(){return iD},div:function(){return i5},divide:function(){return iL},dot:function(){return iX},equals:function(){return i1},exactEquals:function(){return i$},floor:function(){return iS},forEach:function(){return i9},fromValues:function(){return iM},inverse:function(){return iq},len:function(){return i0},length:function(){return ik},lerp:function(){return iN},max:function(){return iP},min:function(){return iA},mul:function(){return i3},multiply:function(){return iT},negate:function(){return iF},normalize:function(){return iV},random:function(){return iY},rotate:function(){return iK},round:function(){return iz},scale:function(){return iR},scaleAndAdd:function(){return iI},set:function(){return ix},sqrDist:function(){return i6},sqrLen:function(){return i8},squaredDistance:function(){return iH},squaredLength:function(){return iO},str:function(){return iJ},sub:function(){return i2},subtract:function(){return iE},transformMat2:function(){return ij},transformMat2d:function(){return iW},transformMat3:function(){return iU},transformMat4:function(){return iG},zero:function(){return iQ}});var x=1e-6,b="undefined"!=typeof Float32Array?Float32Array:Array,E=Math.random;function T(t){b=t}var L=Math.PI/180;function C(t){return t*L}function S(t,e){return Math.abs(t-e)<=x*Math.max(1,Math.abs(t),Math.abs(e))}function A(){var t=new b(4);return b!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function P(t){var e=new b(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function R(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function I(t,e,n,r){var i=new b(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function D(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function H(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function k(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*o-i*r;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=n*s,t):null}function O(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function F(t){return t[0]*t[3]-t[2]*t[1]}function q(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=r*a+o*h,t[1]=i*a+s*h,t[2]=r*u+o*c,t[3]=i*u+s*c,t}function V(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=r*h+o*a,t[1]=i*h+s*a,t[2]=-(r*a)+o*h,t[3]=-(i*a)+s*h,t}function X(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],h=n[1];return t[0]=r*a,t[1]=i*a,t[2]=o*h,t[3]=s*h,t}function B(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function N(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function Y(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function j(t){return Math.hypot(t[0],t[1],t[2],t[3])}function W(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function U(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function G(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function K(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Z(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],h=e[2],u=e[3];return Math.abs(n-s)<=x*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=x*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-h)<=x*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-u)<=x*Math.max(1,Math.abs(o),Math.abs(u))}function Q(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function J(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var $=q,tt=G;function te(){var t=new b(6);return b!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function tn(t){var e=new b(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function tr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function ti(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function to(t,e,n,r,i,o){var s=new b(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s[4]=i,s[5]=o,s}function ts(t,e,n,r,i,o,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t}function ta(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=n*o-r*i;return h?(h=1/h,t[0]=o*h,t[1]=-r*h,t[2]=-i*h,t[3]=n*h,t[4]=(i*a-o*s)*h,t[5]=(r*s-n*a)*h,t):null}function th(t){return t[0]*t[3]-t[1]*t[2]}function tu(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=n[0],c=n[1],l=n[2],f=n[3],p=n[4],d=n[5];return t[0]=r*u+o*c,t[1]=i*u+s*c,t[2]=r*l+o*f,t[3]=i*l+s*f,t[4]=r*p+o*d+a,t[5]=i*p+s*d+h,t}function tc(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*u,t[1]=i*c+s*u,t[2]=-(r*u)+o*c,t[3]=-(i*u)+s*c,t[4]=a,t[5]=h,t}function tl(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=r*u,t[1]=i*u,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=h,t}function tf(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=r*u+o*c+a,t[5]=i*u+s*c+h,t}function tp(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function td(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function tv(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function tm(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function t_(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ty(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function tg(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function tM(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function tw(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function tx(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function tb(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],h=e[0],u=e[1],c=e[2],l=e[3],f=e[4],p=e[5];return Math.abs(n-h)<=x*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-u)<=x*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-c)<=x*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-l)<=x*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-f)<=x*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-p)<=x*Math.max(1,Math.abs(a),Math.abs(p))}var tE=tu,tT=tg;function tL(){var t=new b(9);return b!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function tC(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function tS(t){var e=new b(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function tA(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function tP(t,e,n,r,i,o,s,a,h){var u=new b(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u[8]=h,u}function tz(t,e,n,r,i,o,s,a,h,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=h,t[8]=u,t}function tR(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function tI(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function tD(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=c*s-a*u,f=-c*o+a*h,p=u*o-s*h,d=n*l+r*f+i*p;return d?(d=1/d,t[0]=l*d,t[1]=(-c*r+i*u)*d,t[2]=(a*r-i*s)*d,t[3]=f*d,t[4]=(c*n-i*h)*d,t[5]=(-a*n+i*o)*d,t[6]=p*d,t[7]=(-u*n+r*h)*d,t[8]=(s*n-r*o)*d,t):null}function tH(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8];return t[0]=s*c-a*u,t[1]=i*u-r*c,t[2]=r*a-i*s,t[3]=a*h-o*c,t[4]=n*c-i*h,t[5]=i*o-n*a,t[6]=o*u-s*h,t[7]=r*h-n*u,t[8]=n*s-r*o,t}function tk(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],h=t[7],u=t[8];return e*(u*o-s*h)+n*(-u*i+s*a)+r*(h*i-o*a)}function tO(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=n[0],p=n[1],d=n[2],v=n[3],m=n[4],_=n[5],y=n[6],g=n[7],M=n[8];return t[0]=f*r+p*s+d*u,t[1]=f*i+p*a+d*c,t[2]=f*o+p*h+d*l,t[3]=v*r+m*s+_*u,t[4]=v*i+m*a+_*c,t[5]=v*o+m*h+_*l,t[6]=y*r+g*s+M*u,t[7]=y*i+g*a+M*c,t[8]=y*o+g*h+M*l,t}function tF(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=n[0],p=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=f*r+p*s+u,t[7]=f*i+p*a+c,t[8]=f*o+p*h+l,t}function tq(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=Math.sin(n),p=Math.cos(n);return t[0]=p*r+f*s,t[1]=p*i+f*a,t[2]=p*o+f*h,t[3]=p*s-f*r,t[4]=p*a-f*i,t[5]=p*h-f*o,t[6]=u,t[7]=c,t[8]=l,t}function tV(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function tX(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function tB(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function tN(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function tY(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function tj(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,h=i+i,u=n*s,c=r*s,l=r*a,f=i*s,p=i*a,d=i*h,v=o*s,m=o*a,_=o*h;return t[0]=1-l-d,t[3]=c-_,t[6]=f+m,t[1]=c+_,t[4]=1-u-d,t[7]=p-v,t[2]=f-m,t[5]=p+v,t[8]=1-u-l,t}function tW(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],_=e[15],y=n*a-r*s,g=n*h-i*s,M=n*u-o*s,w=r*h-i*a,x=r*u-o*a,b=i*u-o*h,E=c*v-l*d,T=c*m-f*d,L=c*_-p*d,C=l*m-f*v,S=l*_-p*v,A=f*_-p*m,P=y*A-g*S+M*C+w*L-x*T+b*E;return P?(P=1/P,t[0]=(a*A-h*S+u*C)*P,t[1]=(h*L-s*A-u*T)*P,t[2]=(s*S-a*L+u*E)*P,t[3]=(i*S-r*A-o*C)*P,t[4]=(n*A-i*L+o*T)*P,t[5]=(r*L-n*S-o*E)*P,t[6]=(v*b-m*x+_*w)*P,t[7]=(m*M-d*b-_*g)*P,t[8]=(d*x-v*M+_*y)*P,t):null}function tU(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function tG(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function tK(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function tZ(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function tQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function tJ(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function t$(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function t1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function t0(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],h=t[6],u=t[7],c=t[8],l=e[0],f=e[1],p=e[2],d=e[3],v=e[4],m=e[5],_=e[6],y=e[7],g=e[8];return Math.abs(n-l)<=x*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-f)<=x*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-p)<=x*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-d)<=x*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-v)<=x*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(a-m)<=x*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(h-_)<=x*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(u-y)<=x*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-g)<=x*Math.max(1,Math.abs(c),Math.abs(g))}var t2=tO,t3=tQ;function t5(){var t=new b(16);return b!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function t4(t){var e=new b(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function t6(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function t8(t,e,n,r,i,o,s,a,h,u,c,l,f,p,d,v){var m=new b(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=s,m[7]=a,m[8]=h,m[9]=u,m[10]=c,m[11]=l,m[12]=f,m[13]=p,m[14]=d,m[15]=v,m}function t9(t,e,n,r,i,o,s,a,h,u,c,l,f,p,d,v,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=h,t[8]=u,t[9]=c,t[10]=l,t[11]=f,t[12]=p,t[13]=d,t[14]=v,t[15]=m,t}function t7(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function et(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ee(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],_=e[15],y=n*a-r*s,g=n*h-i*s,M=n*u-o*s,w=r*h-i*a,x=r*u-o*a,b=i*u-o*h,E=c*v-l*d,T=c*m-f*d,L=c*_-p*d,C=l*m-f*v,S=l*_-p*v,A=f*_-p*m,P=y*A-g*S+M*C+w*L-x*T+b*E;return P?(P=1/P,t[0]=(a*A-h*S+u*C)*P,t[1]=(i*S-r*A-o*C)*P,t[2]=(v*b-m*x+_*w)*P,t[3]=(f*x-l*b-p*w)*P,t[4]=(h*L-s*A-u*T)*P,t[5]=(n*A-i*L+o*T)*P,t[6]=(m*M-d*b-_*g)*P,t[7]=(c*b-f*M+p*g)*P,t[8]=(s*S-a*L+u*E)*P,t[9]=(r*L-n*S-o*E)*P,t[10]=(d*x-v*M+_*y)*P,t[11]=(l*M-c*x-p*y)*P,t[12]=(a*T-s*C-h*E)*P,t[13]=(n*C-r*T+i*E)*P,t[14]=(v*g-d*w-m*y)*P,t[15]=(c*w-l*g+f*y)*P,t):null}function en(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],f=e[10],p=e[11],d=e[12],v=e[13],m=e[14],_=e[15];return t[0]=a*(f*_-p*m)-l*(h*_-u*m)+v*(h*p-u*f),t[1]=-(r*(f*_-p*m)-l*(i*_-o*m)+v*(i*p-o*f)),t[2]=r*(h*_-u*m)-a*(i*_-o*m)+v*(i*u-o*h),t[3]=-(r*(h*p-u*f)-a*(i*p-o*f)+l*(i*u-o*h)),t[4]=-(s*(f*_-p*m)-c*(h*_-u*m)+d*(h*p-u*f)),t[5]=n*(f*_-p*m)-c*(i*_-o*m)+d*(i*p-o*f),t[6]=-(n*(h*_-u*m)-s*(i*_-o*m)+d*(i*u-o*h)),t[7]=n*(h*p-u*f)-s*(i*p-o*f)+c*(i*u-o*h),t[8]=s*(l*_-p*v)-c*(a*_-u*v)+d*(a*p-u*l),t[9]=-(n*(l*_-p*v)-c*(r*_-o*v)+d*(r*p-o*l)),t[10]=n*(a*_-u*v)-s*(r*_-o*v)+d*(r*u-o*a),t[11]=-(n*(a*p-u*l)-s*(r*p-o*l)+c*(r*u-o*a)),t[12]=-(s*(l*m-f*v)-c*(a*m-h*v)+d*(a*f-h*l)),t[13]=n*(l*m-f*v)-c*(r*m-i*v)+d*(r*f-i*l),t[14]=-(n*(a*m-h*v)-s*(r*m-i*v)+d*(r*h-i*a)),t[15]=n*(a*f-h*l)-s*(r*f-i*l)+c*(r*h-i*a),t}function er(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],f=t[11],p=t[12],d=t[13],v=t[14],m=t[15];return(e*s-n*o)*(l*m-f*v)-(e*a-r*o)*(c*m-f*d)+(e*h-i*o)*(c*v-l*d)+(n*a-r*s)*(u*m-f*p)-(n*h-i*s)*(u*v-l*p)+(r*h-i*a)*(u*d-c*p)}function ei(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],d=e[11],v=e[12],m=e[13],_=e[14],y=e[15],g=n[0],M=n[1],w=n[2],x=n[3];return t[0]=g*r+M*a+w*l+x*v,t[1]=g*i+M*h+w*f+x*m,t[2]=g*o+M*u+w*p+x*_,t[3]=g*s+M*c+w*d+x*y,g=n[4],M=n[5],w=n[6],x=n[7],t[4]=g*r+M*a+w*l+x*v,t[5]=g*i+M*h+w*f+x*m,t[6]=g*o+M*u+w*p+x*_,t[7]=g*s+M*c+w*d+x*y,g=n[8],M=n[9],w=n[10],x=n[11],t[8]=g*r+M*a+w*l+x*v,t[9]=g*i+M*h+w*f+x*m,t[10]=g*o+M*u+w*p+x*_,t[11]=g*s+M*c+w*d+x*y,g=n[12],M=n[13],w=n[14],x=n[15],t[12]=g*r+M*a+w*l+x*v,t[13]=g*i+M*h+w*f+x*m,t[14]=g*o+M*u+w*p+x*_,t[15]=g*s+M*c+w*d+x*y,t}function eo(t,e,n){var r,i,o,s,a,h,u,c,l,f,p,d,v=n[0],m=n[1],_=n[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*_+e[12],t[13]=e[1]*v+e[5]*m+e[9]*_+e[13],t[14]=e[2]*v+e[6]*m+e[10]*_+e[14],t[15]=e[3]*v+e[7]*m+e[11]*_+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=u,t[7]=c,t[8]=l,t[9]=f,t[10]=p,t[11]=d,t[12]=r*v+a*m+l*_+e[12],t[13]=i*v+h*m+f*_+e[13],t[14]=o*v+u*m+p*_+e[14],t[15]=s*v+c*m+d*_+e[15]),t}function es(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ea(t,e,n,r){var i,o,s,a,h,u,c,l,f,p,d,v,m,_,y,g,M,w,b,E,T,L,C,S,A=r[0],P=r[1],z=r[2],R=Math.hypot(A,P,z);return R<x?null:(A*=R=1/R,P*=R,z*=R,i=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],h=e[1],u=e[2],c=e[3],l=e[4],f=e[5],p=e[6],d=e[7],v=e[8],m=e[9],_=e[10],y=e[11],g=A*A*s+o,M=P*A*s+z*i,w=z*A*s-P*i,b=A*P*s-z*i,E=P*P*s+o,T=z*P*s+A*i,L=A*z*s+P*i,C=P*z*s-A*i,S=z*z*s+o,t[0]=a*g+l*M+v*w,t[1]=h*g+f*M+m*w,t[2]=u*g+p*M+_*w,t[3]=c*g+d*M+y*w,t[4]=a*b+l*E+v*T,t[5]=h*b+f*E+m*T,t[6]=u*b+p*E+_*T,t[7]=c*b+d*E+y*T,t[8]=a*L+l*C+v*S,t[9]=h*L+f*C+m*S,t[10]=u*L+p*C+_*S,t[11]=c*L+d*C+y*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function eh(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],h=e[7],u=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+u*r,t[5]=s*i+c*r,t[6]=a*i+l*r,t[7]=h*i+f*r,t[8]=u*i-o*r,t[9]=c*i-s*r,t[10]=l*i-a*r,t[11]=f*i-h*r,t}function eu(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],h=e[3],u=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-u*r,t[1]=s*i-c*r,t[2]=a*i-l*r,t[3]=h*i-f*r,t[8]=o*r+u*i,t[9]=s*r+c*i,t[10]=a*r+l*i,t[11]=h*r+f*i,t}function ec(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],h=e[3],u=e[4],c=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+u*r,t[1]=s*i+c*r,t[2]=a*i+l*r,t[3]=h*i+f*r,t[4]=u*i-o*r,t[5]=c*i-s*r,t[6]=l*i-a*r,t[7]=f*i-h*r,t}function el(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ef(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ep(t,e,n){var r,i,o,s=n[0],a=n[1],h=n[2],u=Math.hypot(s,a,h);return u<x?null:(s*=u=1/u,a*=u,h*=u,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=s*s*o+i,t[1]=a*s*o+h*r,t[2]=h*s*o-a*r,t[3]=0,t[4]=s*a*o-h*r,t[5]=a*a*o+i,t[6]=h*a*o+s*r,t[7]=0,t[8]=s*h*o+a*r,t[9]=a*h*o-s*r,t[10]=h*h*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function ed(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ev(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function em(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function e_(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=r+r,h=i+i,u=o+o,c=r*a,l=r*h,f=r*u,p=i*h,d=i*u,v=o*u,m=s*a,_=s*h,y=s*u;return t[0]=1-(p+v),t[1]=l+y,t[2]=f-_,t[3]=0,t[4]=l-y,t[5]=1-(c+v),t[6]=d+m,t[7]=0,t[8]=f+_,t[9]=d-m,t[10]=1-(c+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ey(t,e){var n=new b(3),r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=r*r+i*i+o*o+s*s;return l>0?(n[0]=(a*s+c*r+h*o-u*i)*2/l,n[1]=(h*s+c*i+u*r-a*o)*2/l,n[2]=(u*s+c*o+a*i-h*r)*2/l):(n[0]=(a*s+c*r+h*o-u*i)*2,n[1]=(h*s+c*i+u*r-a*o)*2,n[2]=(u*s+c*o+a*i-h*r)*2),e_(t,e,n),t}function eg(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function eM(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],h=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(h,u,c),t}function ew(t,e){var n=new b(3);eM(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],s=e[0]*r,a=e[1]*i,h=e[2]*o,u=e[4]*r,c=e[5]*i,l=e[6]*o,f=e[8]*r,p=e[9]*i,d=e[10]*o,v=s+c+d,m=0;return v>0?(m=2*Math.sqrt(v+1),t[3]=.25*m,t[0]=(l-p)/m,t[1]=(f-h)/m,t[2]=(a-u)/m):s>c&&s>d?(m=2*Math.sqrt(1+s-c-d),t[3]=(l-p)/m,t[0]=.25*m,t[1]=(a+u)/m,t[2]=(f+h)/m):c>d?(m=2*Math.sqrt(1+c-s-d),t[3]=(f-h)/m,t[0]=(a+u)/m,t[1]=.25*m,t[2]=(l+p)/m):(m=2*Math.sqrt(1+d-s-c),t[3]=(a-u)/m,t[0]=(f+h)/m,t[1]=(l+p)/m,t[2]=.25*m),t}function ex(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3],h=i+i,u=o+o,c=s+s,l=i*h,f=i*u,p=i*c,d=o*u,v=o*c,m=s*c,_=a*h,y=a*u,g=a*c,M=r[0],w=r[1],x=r[2];return t[0]=(1-(d+m))*M,t[1]=(f+g)*M,t[2]=(p-y)*M,t[3]=0,t[4]=(f-g)*w,t[5]=(1-(l+m))*w,t[6]=(v+_)*w,t[7]=0,t[8]=(p+y)*x,t[9]=(v-_)*x,t[10]=(1-(l+d))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function eb(t,e,n,r,i){var o=e[0],s=e[1],a=e[2],h=e[3],u=o+o,c=s+s,l=a+a,f=o*u,p=o*c,d=o*l,v=s*c,m=s*l,_=a*l,y=h*u,g=h*c,M=h*l,w=r[0],x=r[1],b=r[2],E=i[0],T=i[1],L=i[2],C=(1-(v+_))*w,S=(p+M)*w,A=(d-g)*w,P=(p-M)*x,z=(1-(f+_))*x,R=(m+y)*x,I=(d+g)*b,D=(m-y)*b,H=(1-(f+v))*b;return t[0]=C,t[1]=S,t[2]=A,t[3]=0,t[4]=P,t[5]=z,t[6]=R,t[7]=0,t[8]=I,t[9]=D,t[10]=H,t[11]=0,t[12]=n[0]+E-(C*E+P*T+I*L),t[13]=n[1]+T-(S*E+z*T+D*L),t[14]=n[2]+L-(A*E+R*T+H*L),t[15]=1,t}function eE(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,h=i+i,u=n*s,c=r*s,l=r*a,f=i*s,p=i*a,d=i*h,v=o*s,m=o*a,_=o*h;return t[0]=1-l-d,t[1]=c+_,t[2]=f-m,t[3]=0,t[4]=c-_,t[5]=1-u-d,t[6]=p+v,t[7]=0,t[8]=f+m,t[9]=p-v,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function eT(t,e,n,r,i,o,s){var a=1/(n-e),h=1/(i-r),u=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*h,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0,t}function eL(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function eC(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(s+a),u=2/(i+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((s-a)*h*.5),t[9]=(i-o)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function eS(t,e,n,r,i,o,s){var a=1/(e-n),h=1/(r-i),u=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*h,t[14]=(s+o)*u,t[15]=1,t}function eA(t,e,n,r){var i,o,s,a,h,u,c,l,f,p,d=e[0],v=e[1],m=e[2],_=r[0],y=r[1],g=r[2],M=n[0],w=n[1],b=n[2];return Math.abs(d-M)<x&&Math.abs(v-w)<x&&Math.abs(m-b)<x?t7(t):(p=1/Math.hypot(c=d-M,l=v-w,f=m-b),c*=p,l*=p,f*=p,(p=Math.hypot(i=y*f-g*l,o=g*c-_*f,s=_*l-y*c))?(i*=p=1/p,o*=p,s*=p):(i=0,o=0,s=0),(p=Math.hypot(a=l*s-f*o,h=f*i-c*s,u=c*o-l*i))?(a*=p=1/p,h*=p,u*=p):(a=0,h=0,u=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=o,t[5]=h,t[6]=l,t[7]=0,t[8]=s,t[9]=u,t[10]=f,t[11]=0,t[12]=-(i*d+o*v+s*m),t[13]=-(a*d+h*v+u*m),t[14]=-(c*d+l*v+f*m),t[15]=1,t)}function eP(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=r[0],h=r[1],u=r[2],c=i-n[0],l=o-n[1],f=s-n[2],p=c*c+l*l+f*f;p>0&&(c*=p=1/Math.sqrt(p),l*=p,f*=p);var d=h*f-u*l,v=u*c-a*f,m=a*l-h*c;return(p=d*d+v*v+m*m)>0&&(d*=p=1/Math.sqrt(p),v*=p,m*=p),t[0]=d,t[1]=v,t[2]=m,t[3]=0,t[4]=l*m-f*v,t[5]=f*d-c*m,t[6]=c*v-l*d,t[7]=0,t[8]=c,t[9]=l,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function ez(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function eR(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function eI(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function eD(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function eH(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function ek(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function eO(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function eF(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],h=t[6],u=t[7],c=t[8],l=t[9],f=t[10],p=t[11],d=t[12],v=t[13],m=t[14],_=t[15],y=e[0],g=e[1],M=e[2],w=e[3],b=e[4],E=e[5],T=e[6],L=e[7],C=e[8],S=e[9],A=e[10],P=e[11],z=e[12],R=e[13],I=e[14],D=e[15];return Math.abs(n-y)<=x*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-g)<=x*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-M)<=x*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-w)<=x*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-b)<=x*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(a-E)<=x*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(h-T)<=x*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(u-L)<=x*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(c-C)<=x*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(l-S)<=x*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(f-A)<=x*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(p-P)<=x*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(d-z)<=x*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(v-R)<=x*Math.max(1,Math.abs(v),Math.abs(R))&&Math.abs(m-I)<=x*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(_-D)<=x*Math.max(1,Math.abs(_),Math.abs(D))}var eq=ei,eV=eD;function eX(){var t=new b(3);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function eB(t){var e=new b(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function eN(t){return Math.hypot(t[0],t[1],t[2])}function eY(t,e,n){var r=new b(3);return r[0]=t,r[1]=e,r[2]=n,r}function ej(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function eW(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function eU(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function eG(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function eK(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function eZ(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function eQ(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function eJ(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function e$(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function e1(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function e0(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function e2(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function e3(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function e5(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function e4(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function e6(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function e8(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function e9(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function e7(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function nt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ne(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],h=n[2];return t[0]=i*h-o*a,t[1]=o*s-r*h,t[2]=r*a-i*s,t}function nn(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function nr(t,e,n,r,i,o){var s=o*o,a=s*(2*o-3)+1,h=s*(o-2)+o,u=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*h+r[0]*u+i[0]*c,t[1]=e[1]*a+n[1]*h+r[1]*u+i[1]*c,t[2]=e[2]*a+n[2]*h+r[2]*u+i[2]*c,t}function ni(t,e,n,r,i,o){var s=1-o,a=s*s,h=o*o,u=a*s,c=3*o*a,l=3*h*s,f=h*o;return t[0]=e[0]*u+n[0]*c+r[0]*l+i[0]*f,t[1]=e[1]*u+n[1]*c+r[1]*l+i[1]*f,t[2]=e[2]*u+n[2]*c+r[2]*l+i[2]*f,t}function no(t,e){e=e||1;var n=2*E()*Math.PI,r=2*E()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function ns(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function na(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function nh(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],h=e[1],u=e[2],c=i*u-o*h,l=o*a-r*u,f=r*h-i*a,p=i*f-o*l,d=o*c-r*f,v=r*l-i*c,m=2*s;return c*=m,l*=m,f*=m,p*=2,d*=2,v*=2,t[0]=a+c+p,t[1]=h+l+d,t[2]=u+f+v,t}function nu(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function nc(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function nl(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function nf(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],h=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a);return Math.acos(Math.min(Math.max(h&&nt(t,e)/h,-1),1))}function np(t){return t[0]=0,t[1]=0,t[2]=0,t}function nd(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function nv(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function nm(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=x*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=x*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=x*Math.max(1,Math.abs(i),Math.abs(a))}var n_=eG,ny=eK,ng=eZ,nM=e5,nw=e4,nx=eN,nb=e6,nE=(r=eX(),function(t,e,n,i,o,s){var a,h;for(e||(e=3),n||(n=0),h=i?Math.min(i*e+n,t.length):t.length,a=n;a<h;a+=e)r[0]=t[a],r[1]=t[a+1],r[2]=t[a+2],o(r,r,s),t[a]=r[0],t[a+1]=r[1],t[a+2]=r[2];return t});function nT(){var t=new b(4);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function nL(t){var e=new b(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function nC(t,e,n,r){var i=new b(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function nS(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function nA(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function nP(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function nz(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function nR(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function nI(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function nD(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function nH(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function nk(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function nO(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function nF(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function nq(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function nV(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function nX(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function nB(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function nN(t){return Math.hypot(t[0],t[1],t[2],t[3])}function nY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function nj(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function nW(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function nU(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function nG(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function nK(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],s=n[0]*r[3]-n[3]*r[0],a=n[1]*r[2]-n[2]*r[1],h=n[1]*r[3]-n[3]*r[1],u=n[2]*r[3]-n[3]*r[2],c=e[0],l=e[1],f=e[2],p=e[3];return t[0]=l*u-f*h+p*a,t[1]=-(c*u)+f*s-p*o,t[2]=c*h-l*s+p*i,t[3]=-(c*a)+l*o-f*i,t}function nZ(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function nQ(t,e){e=e||1;do s=(n=2*E()-1)*n+(r=2*E()-1)*r;while(s>=1);do a=(i=2*E()-1)*i+(o=2*E()-1)*o;while(a>=1);var n,r,i,o,s,a,h=Math.sqrt((1-s)/a);return t[0]=e*n,t[1]=e*r,t[2]=e*i*h,t[3]=e*o*h,t}function nJ(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function n$(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],h=n[2],u=n[3],c=u*r+a*o-h*i,l=u*i+h*r-s*o,f=u*o+s*i-a*r,p=-s*r-a*i-h*o;return t[0]=c*u+-(p*s)+-(l*h)- -(f*a),t[1]=l*u+-(p*a)+-(f*s)- -(c*h),t[2]=f*u+-(p*h)+-(c*a)- -(l*s),t[3]=e[3],t}function n1(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function n0(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function n2(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function n3(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],h=e[2],u=e[3];return Math.abs(n-s)<=x*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=x*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-h)<=x*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-u)<=x*Math.max(1,Math.abs(o),Math.abs(u))}var n5=nz,n4=nR,n6=nI,n8=nX,n9=nB,n7=nN,rt=nY,re=(i=nT(),function(t,e,n,r,o,s){var a,h;for(e||(e=4),n||(n=0),h=r?Math.min(r*e+n,t.length):t.length,a=n;a<h;a+=e)i[0]=t[a],i[1]=t[a+1],i[2]=t[a+2],i[3]=t[a+3],o(i,i,s),t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2],t[a+3]=i[3];return t});function rn(){var t=new b(4);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function rr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ri(t,e,n){var r=Math.sin(n*=.5);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ro(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>x?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function rs(t,e){var n=rA(t,e);return Math.acos(2*n*n-1)}function ra(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*h,t[1]=i*c+s*h+o*a-r*u,t[2]=o*c+s*u+r*h-i*a,t[3]=s*c-r*a-i*h-o*u,t}function rh(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=r*h+s*a,t[1]=i*h+o*a,t[2]=o*h-i*a,t[3]=s*h-r*a,t}function ru(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=r*h-o*a,t[1]=i*h+s*a,t[2]=o*h+r*a,t[3]=s*h-i*a,t}function rc(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=r*h+i*a,t[1]=i*h-r*a,t[2]=o*h+s*a,t[3]=s*h-o*a,t}function rl(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function rf(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=Math.exp(o),h=s>0?a*Math.sin(s)/s:0;return t[0]=n*h,t[1]=r*h,t[2]=i*h,t[3]=a*Math.cos(s),t}function rp(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function rd(t,e,n){return rp(t,e),rS(t,t,n),rf(t,t),t}function rv(t,e,n,r){var i,o,s,a,h,u=e[0],c=e[1],l=e[2],f=e[3],p=n[0],d=n[1],v=n[2],m=n[3];return(o=u*p+c*d+l*v+f*m)<0&&(o=-o,p=-p,d=-d,v=-v,m=-m),1-o>x?(s=Math.sin(i=Math.acos(o)),a=Math.sin((1-r)*i)/s,h=Math.sin(r*i)/s):(a=1-r,h=r),t[0]=a*u+h*p,t[1]=a*c+h*d,t[2]=a*l+h*v,t[3]=a*f+h*m,t}function rm(t){var e=E(),n=E(),r=E(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function r_(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t}function ry(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function rg(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}function rM(t,e,n,r){var i=.5*Math.PI/180,o=Math.sin(e*=i),s=Math.cos(e),a=Math.sin(n*=i),h=Math.cos(n),u=Math.sin(r*=i),c=Math.cos(r);return t[0]=o*h*c-s*a*u,t[1]=s*a*c+o*h*u,t[2]=s*h*u-o*a*c,t[3]=s*h*c+o*a*u,t}function rw(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var rx=nL,rb=nC,rE=nS,rT=nA,rL=nP,rC=ra,rS=nq,rA=nG,rP=nZ,rz=nN,rR=rz,rI=nY,rD=rI,rH=nU,rk=n2,rO=n3,rF=(o=eX(),s=eY(1,0,0),a=eY(0,1,0),function(t,e,n){var r=nt(e,n);return r<-.999999?(ne(o,s,e),1e-6>nx(o)&&ne(o,a,e),e7(o,o),ri(t,o,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ne(o,e,n),t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=1+r,rH(t,t))}),rq=(h=rn(),u=rn(),function(t,e,n,r,i,o){return rv(h,e,i,o),rv(u,n,r,o),rv(t,h,u,2*o*(1-o)),t}),rV=(c=tL(),function(t,e,n,r){return c[0]=n[0],c[3]=n[1],c[6]=n[2],c[1]=r[0],c[4]=r[1],c[7]=r[2],c[2]=-e[0],c[5]=-e[1],c[8]=-e[2],rH(t,rg(t,c))});function rX(){var t=new b(8);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function rB(t){var e=new b(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function rN(t,e,n,r,i,o,s,a){var h=new b(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=i,h[5]=o,h[6]=s,h[7]=a,h}function rY(t,e,n,r,i,o,s){var a=new b(8);a[0]=t,a[1]=e,a[2]=n,a[3]=r;var h=.5*i,u=.5*o,c=.5*s;return a[4]=h*r+u*n-c*e,a[5]=u*r+c*t-h*n,a[6]=c*r+h*e-u*t,a[7]=-h*t-u*e-c*n,a}function rj(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],s=e[0],a=e[1],h=e[2],u=e[3];return t[0]=s,t[1]=a,t[2]=h,t[3]=u,t[4]=r*u+i*h-o*a,t[5]=i*u+o*s-r*h,t[6]=o*u+r*a-i*s,t[7]=-r*s-i*a-o*h,t}function rW(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function rU(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function rG(t,e){var n=rn();ew(n,e);var r=new b(3);return eg(r,e),rj(t,n,r),t}function rK(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function rZ(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function rQ(t,e,n,r,i,o,s,a,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=h,t}var rJ=rE;function r$(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var r1=rE;function r0(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function r2(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],s=-e[0],a=-e[1],h=-e[2],u=e[3];return t[0]=(n*u+o*s+r*h-i*a)*2,t[1]=(r*u+o*a+i*s-n*h)*2,t[2]=(i*u+o*h+n*a-r*s)*2,t}function r3(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=.5*n[0],h=.5*n[1],u=.5*n[2],c=e[4],l=e[5],f=e[6],p=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=s*a+i*u-o*h+c,t[5]=s*h+o*a-r*u+l,t[6]=s*u+r*h-i*a+f,t[7]=-r*a-i*h-o*u+p,t}function r5(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=a*s+c*r+h*o-u*i,f=h*s+c*i+u*r-a*o,p=u*s+c*o+a*i-h*r,d=c*s-a*r-h*i-u*o;return rh(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+f*o-p*i,t[5]=f*s+d*i+p*r-l*o,t[6]=p*s+d*o+l*i-f*r,t[7]=d*s-l*r-f*i-p*o,t}function r4(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=a*s+c*r+h*o-u*i,f=h*s+c*i+u*r-a*o,p=u*s+c*o+a*i-h*r,d=c*s-a*r-h*i-u*o;return ru(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+f*o-p*i,t[5]=f*s+d*i+p*r-l*o,t[6]=p*s+d*o+l*i-f*r,t[7]=d*s-l*r-f*i-p*o,t}function r6(t,e,n){var r=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=a*s+c*r+h*o-u*i,f=h*s+c*i+u*r-a*o,p=u*s+c*o+a*i-h*r,d=c*s-a*r-h*i-u*o;return rc(t,e,n),r=t[0],i=t[1],o=t[2],s=t[3],t[4]=l*s+d*r+f*o-p*i,t[5]=f*s+d*i+p*r-l*o,t[6]=p*s+d*o+l*i-f*r,t[7]=d*s-l*r-f*i-p*o,t}function r8(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],h=e[1],u=e[2],c=e[3];return t[0]=a*s+c*r+h*o-u*i,t[1]=h*s+c*i+u*r-a*o,t[2]=u*s+c*o+a*i-h*r,t[3]=c*s-a*r-h*i-u*o,a=e[4],h=e[5],u=e[6],c=e[7],t[4]=a*s+c*r+h*o-u*i,t[5]=h*s+c*i+u*r-a*o,t[6]=u*s+c*o+a*i-h*r,t[7]=c*s-a*r-h*i-u*o,t}function r9(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*h,t[1]=i*c+s*h+o*a-r*u,t[2]=o*c+s*u+r*h-i*a,t[3]=s*c-r*a-i*h-o*u,a=n[4],h=n[5],u=n[6],c=n[7],t[4]=r*c+s*a+i*u-o*h,t[5]=i*c+s*h+o*a-r*u,t[6]=o*c+s*u+r*h-i*a,t[7]=s*c-r*a-i*h-o*u,t}function r7(t,e,n,r){if(Math.abs(r)<x)return rK(t,e);var i=Math.hypot(n[0],n[1],n[2]),o=Math.sin(r*=.5),s=o*n[0]/i,a=o*n[1]/i,h=o*n[2]/i,u=Math.cos(r),c=e[0],l=e[1],f=e[2],p=e[3];t[0]=c*u+p*s+l*h-f*a,t[1]=l*u+p*a+f*s-c*h,t[2]=f*u+p*h+c*a-l*s,t[3]=p*u-c*s-l*a-f*h;var d=e[4],v=e[5],m=e[6],_=e[7];return t[4]=d*u+_*s+v*h-m*a,t[5]=v*u+_*a+m*s-d*h,t[6]=m*u+_*h+d*a-v*s,t[7]=_*u-d*s-v*a-m*h,t}function it(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function ie(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[4],h=n[5],u=n[6],c=n[7],l=e[4],f=e[5],p=e[6],d=e[7],v=n[0],m=n[1],_=n[2],y=n[3];return t[0]=r*y+s*v+i*_-o*m,t[1]=i*y+s*m+o*v-r*_,t[2]=o*y+s*_+r*m-i*v,t[3]=s*y-r*v-i*m-o*_,t[4]=r*c+s*a+i*u-o*h+l*y+d*v+f*_-p*m,t[5]=i*c+s*h+o*a-r*u+f*y+d*m+p*v-l*_,t[6]=o*c+s*u+r*h-i*a+p*y+d*_+l*m-f*v,t[7]=s*c-r*a-i*h-o*u+d*y-l*v-f*m-p*_,t}var ir=ie;function ii(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var io=rA;function is(t,e,n,r){var i=1-r;return 0>io(e,n)&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function ia(t,e){var n=il(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function ih(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var iu=rz,ic=iu,il=rI,ip=il;function id(t,e){var n=il(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,s=e[3]/n,a=e[4],h=e[5],u=e[6],c=e[7],l=r*a+i*h+o*u+s*c;t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=(a-r*l)/n,t[5]=(h-i*l)/n,t[6]=(u-o*l)/n,t[7]=(c-s*l)/n}return t}function iv(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function im(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function i_(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],h=t[6],u=t[7],c=e[0],l=e[1],f=e[2],p=e[3],d=e[4],v=e[5],m=e[6],_=e[7];return Math.abs(n-c)<=x*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-l)<=x*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-f)<=x*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-p)<=x*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-d)<=x*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-v)<=x*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(h-m)<=x*Math.max(1,Math.abs(h),Math.abs(m))&&Math.abs(u-_)<=x*Math.max(1,Math.abs(u),Math.abs(_))}function iy(){var t=new b(2);return b!=Float32Array&&(t[0]=0,t[1]=0),t}function ig(t){var e=new b(2);return e[0]=t[0],e[1]=t[1],e}function iM(t,e){var n=new b(2);return n[0]=t,n[1]=e,n}function iw(t,e){return t[0]=e[0],t[1]=e[1],t}function ix(t,e,n){return t[0]=e,t[1]=n,t}function ib(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function iE(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function iT(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function iL(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function iC(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function iS(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function iA(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function iP(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function iz(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function iR(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function iI(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function iD(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function iH(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ik(t){return Math.hypot(t[0],t[1])}function iO(t){var e=t[0],n=t[1];return e*e+n*n}function iF(t,e){return t[0]=-e[0],t[1]=-e[1],t}function iq(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function iV(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function iX(t,e){return t[0]*e[0]+t[1]*e[1]}function iB(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function iN(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function iY(t,e){e=e||1;var n=2*E()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function ij(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function iW(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function iU(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function iG(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function iK(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),a=Math.cos(r);return t[0]=i*a-o*s+n[0],t[1]=i*s+o*a+n[1],t}function iZ(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o);return Math.acos(Math.min(Math.max(s&&(n*i+r*o)/s,-1),1))}function iQ(t){return t[0]=0,t[1]=0,t}function iJ(t){return"vec2("+t[0]+", "+t[1]+")"}function i$(t,e){return t[0]===e[0]&&t[1]===e[1]}function i1(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=x*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=x*Math.max(1,Math.abs(r),Math.abs(o))}var i0=ik,i2=iE,i3=iT,i5=iL,i4=iD,i6=iH,i8=iO,i9=(l=iy(),function(t,e,n,r,i,o){var s,a;for(e||(e=2),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,s=n;s<a;s+=e)l[0]=t[s],l[1]=t[s+1],i(l,l,o),t[s]=l[0],t[s+1]=l[1];return t})},840:function(t,e,n){var r; /*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */ !function(i,o,s,a){"use strict";var h=["","webkit","moz","MS","ms","o"],u=o.createElement("div"),c=Math.round,l=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(g(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var r;if(t){if(t.forEach)t.forEach(e,n);else if(a!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}}function m(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&a===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}function _(t,e){return m(t,e,!0)}function y(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&m(r,n)}function g(t,e){return function(){return t.apply(e,arguments)}}function M(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function w(t,e,n){v(T(e),function(e){t.addEventListener(e,n,!1)})}function x(t,e,n){v(T(e),function(e){t.removeEventListener(e,n,!1)})}function b(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function E(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function L(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return -1}function C(t){return Array.prototype.slice.call(t,0)}function S(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];0>L(i,s)&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function A(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<h.length;){if((r=(n=h[o])?n+i:e)in t)return r;o++}}var P=1;function z(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}var R="ontouchstart"in i,I=a!==A(i,"PointerEvent"),D=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),H="touch",k="mouse",O=["x","y"],F=["clientX","clientY"];function q(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){M(t.options.enable,[t])&&n.handler(e)},this.init()}function V(t,e,n){var r,i,o,s,h,u,c,p,d,v,m,_,y,g,M,w,x,E=n.pointers.length,T=n.changedPointers.length,L=1&e&&E-T==0;n.isFirst=!!L,n.isFinal=!!(12&e&&E-T==0),L&&(t.session={}),n.eventType=e,r=n,i=t.session,s=(o=r.pointers).length,i.firstInput||(i.firstInput=X(r)),s>1&&!i.firstMultiple?i.firstMultiple=X(r):1===s&&(i.firstMultiple=!1),h=i.firstInput,c=(u=i.firstMultiple)?u.center:h.center,p=r.center=B(o),r.timeStamp=f(),r.deltaTime=r.timeStamp-h.timeStamp,r.angle=j(c,p),r.distance=Y(c,p),d=i,m=(v=r).center,_=d.offsetDelta||{},y=d.prevDelta||{},g=d.prevInput||{},(1===v.eventType||4===g.eventType)&&(y=d.prevDelta={x:g.deltaX||0,y:g.deltaY||0},_=d.offsetDelta={x:m.x,y:m.y}),v.deltaX=y.x+(m.x-_.x),v.deltaY=y.y+(m.y-_.y),r.offsetDirection=N(r.deltaX,r.deltaY),r.scale=u?(M=u.pointers,Y(o[0],o[1],F)/Y(M[0],M[1],F)):1,r.rotation=u?(w=u.pointers,j(o[1],o[0],F)-j(w[1],w[0],F)):0,function(t,e){var n,r,i,o,s=t.lastInterval||e,h=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(h>25||a===s.velocity)){var u=s.deltaX-e.deltaX,c=s.deltaY-e.deltaY,f={x:u/h||0,y:c/h||0};r=f.x,i=f.y,n=l(f.x)>l(f.y)?f.x:f.y,o=N(u,c),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(i,r),x=t.element,b(r.srcEvent.target,x)&&(x=r.srcEvent.target),r.target=x,t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function X(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:c(t.pointers[n].clientX),clientY:c(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:B(e),deltaX:t.deltaX,deltaY:t.deltaY}}function B(t){var e=t.length;if(1===e)return{x:c(t[0].clientX),y:c(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:c(n/e),y:c(r/e)}}function N(t,e){return t===e?1:l(t)>=l(e)?t>0?2:4:e>0?8:16}function Y(t,e,n){n||(n=O);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function j(t,e,n){n||(n=O);var r=e[n[0]]-t[n[0]];return 180*Math.atan2(e[n[1]]-t[n[1]],r)/Math.PI}q.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(z(this.element),this.evWin,this.domHandler)}};var W={mousedown:1,mousemove:2,mouseup:4};function U(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.allow=!0,this.pressed=!1,q.apply(this,arguments)}y(U,q,{handler:function(t){var e=W[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&this.allow&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:k,srcEvent:t}))}});var G={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:H,3:"pen",4:k,5:"kinect"},Z="pointerdown",Q="pointermove pointerup pointercancel";function J(){this.evEl=Z,this.evWin=Q,q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&(Z="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),y(J,q,{handler:function(t){var e=this.store,n=!1,r=G[t.type.toLowerCase().replace("ms","")],i=K[t.pointerType]||t.pointerType,o=L(e,t.pointerId,"pointerId");1&r&&(0===t.button||i==H)?o<0&&(e.push(t),o=e.length-1):12&r&&(n=!0),!(o<0)&&(e[o]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:i,srcEvent:t}),n&&e.splice(o,1))}});var $={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function tt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,q.apply(this,arguments)}function te(t,e){var n=C(t.touches),r=C(t.changedTouches);return 12&e&&(n=S(n.concat(r),"identifier",!0)),[n,r]}y(tt,q,{handler:function(t){var e=$[t.type];if(1===e&&(this.started=!0),this.started){var n=te.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:H,srcEvent:t})}}});var tn={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function tr(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},q.apply(this,arguments)}function ti(t,e){var n=C(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=C(t.changedTouches),a=[],h=this.target;if(o=n.filter(function(t){return b(t.target,h)}),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;if(a.length)return[S(o.concat(a),"identifier",!0),a]}function to(){q.apply(this,arguments);var t=g(this.handler,this);this.touch=new tr(this.manager,t),this.mouse=new U(this.manager,t)}y(tr,q,{handler:function(t){var e=tn[t.type],n=ti.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:H,srcEvent:t})}}),y(to,q,{handler:function(t,e,n){var r=n.pointerType==H,i=n.pointerType==k;if(r)this.mouse.allow=!1;else if(i&&!this.mouse.allow)return;12&e&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ts=A(u.style,"touchAction"),ta=a!==ts,th="compute",tu="auto",tc="manipulation",tl="none",tf="pan-x",tp="pan-y";function td(t,e){this.manager=t,this.set(e)}function tv(t){var e;this.id=P++,this.manager=null,this.options=_(t||{},this.defaults),this.options.enable=a===(e=this.options.enable)||e,this.state=1,this.simultaneous={},this.requireFail=[]}function tm(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function t_(t,e){var n=e.manager;return n?n.get(t):t}function ty(){tv.apply(this,arguments)}function tg(){ty.apply(this,arguments),this.pX=null,this.pY=null}function tM(){ty.apply(this,arguments)}function tw(){tv.apply(this,arguments),this._timer=null,this._input=null}function tx(){ty.apply(this,arguments)}function tb(){ty.apply(this,arguments)}function tE(){tv.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function tT(t,e){var n,r;return(e=e||{}).recognizers=(n=e.recognizers,r=tT.defaults.preset,a===n?r:n),new tL(t,e)}function tL(t,e){var n;e=e||{},this.options=_(e,tT.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=new((n=this.options.inputClass)?n:I?J:D?tr:R?to:U)(this,V),this.touchAction=new td(this,this.options.touchAction),tC(this,!0),v(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function tC(t,e){var n=t.element;v(t.options.cssProps,function(t,r){n.style[A(n.style,r)]=e?t:""})}td.prototype={set:function(t){t==th&&(t=this.compute()),ta&&(this.manager.element.style[ts]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,function(e){M(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(E(t,tl))return tl;var e=E(t,tf),n=E(t,tp);return e&&n?tf+" "+tp:e||n?e?tf:tp:E(t,tc)?tc:tu}(t.join(" "))},preventDefaults:function(t){if(!ta){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented){e.preventDefault();return}var r=this.actions,i=E(r,tl),o=E(r,tp),s=E(r,tf);if(i||o&&6&n||s&&24&n)return this.preventSrc(e)}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}},tv.prototype={defaults:{},set:function(t){return m(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=t_(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=t_(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return -1===L(e,t=t_(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=t_(t,this);var e=L(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(r){e.manager.emit(e.options.event+(r?16&n?"cancel":8&n?"end":4&n?"move":2&n?"start":"":""),t)}n<8&&r(!0),r(),n>=8&&r(!0)},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=m({},t);if(!M(this.options.enable,[this,e])){this.reset(),this.state=32;return}56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},y(ty,tv,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),y(tg,ty,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(tp),24&t&&e.push(tf),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return ty.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=tm(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),y(tM,ty,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tl]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),y(tw,tv,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[tu]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,r&&n&&(!(12&t.eventType)||i)){if(1&t.eventType)this.reset(),this._timer=p(function(){this.state=8,this.tryEmit()},e.time,this);else if(4&t.eventType)return 8}else this.reset();return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),y(tx,ty,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tl]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),y(tb,ty,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return tg.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.velocity:6&n?e=t.velocityX:24&n&&(e=t.velocityY),this._super.attrTest.call(this,t)&&n&t.direction&&t.distance>this.options.threshold&&l(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=tm(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),y(tE,tv,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[tc]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||Y(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),tT.VERSION="2.0.4",tT.defaults={domEvents:!1,touchAction:th,enable:!0,inputTarget:null,inputClass:null,preset:[[tx,{enable:!1}],[tM,{enable:!1},["rotate"]],[tb,{direction:6}],[tg,{direction:6},["swipe"]],[tE],[tE,{event:"doubletap",taps:2},["tap"]],[tw]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},tL.prototype={set:function(t){return m(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e,n=this.session;if(!n.stopped){this.touchAction.preventDefaults(t);var r=this.recognizers,i=n.curRecognizer;(!i||i&&8&i.state)&&(i=n.curRecognizer=null);for(var o=0;o<r.length;)e=r[o],2!==n.stopped&&(!i||e==i||e.canRecognizeWith(i))?e.recognize(t):e.reset(),!i&&14&e.state&&(i=n.curRecognizer=e),o++}},get:function(t){if(t instanceof tv)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(L(e,t),1),this.touchAction.update(),this},on:function(t,e){var n=this.handlers;return v(T(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return v(T(t),function(t){e?n[t].splice(L(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&((n=o.createEvent("Event")).initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n));var n,r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](e),i++}},destroy:function(){this.element&&tC(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},m(tT,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:tL,Input:q,TouchAction:td,TouchInput:tr,MouseInput:U,PointerEventInput:J,TouchMouseInput:to,SingleTouchInput:tt,Recognizer:tv,AttrRecognizer:ty,Tap:tE,Pan:tg,Swipe:tb,Pinch:tM,Rotate:tx,Press:tw,on:w,off:x,each:v,merge:_,extend:m,inherit:y,bindFn:g,prefixed:A}),n.amdO?a!==(r=(function(){return tT}).call(e,n,e,t))&&(t.exports=r):t.exports?t.exports=tT:i[s]=tT}(window,document,"Hammer")},1154:function(t,e,n){"use strict";var r=n(5696),i=n(7691),o=n(6939).setTransform,s=n(6112);function a(t,e,n,r,i){(i=i||{}).perspective=i.perspective||{},i.perspective.extraTransforms=null!=i.perspective.extraTransforms?i.perspective.extraTransforms:"",this._domElement=t,this._parentDomElement=e,this._view=n,this._coords={},this._perspective={},this.setPosition(r),this._parentDomElement.appendChild(this._domElement),this.setPerspective(i.perspective),this._visible=!0,this._position={x:0,y:0}}r(a),a.prototype.destroy=function(){this._parentDomElement.removeChild(this._domElement),s(this)},a.prototype.domElement=function(){return this._domElement},a.prototype.position=function(){return this._coords},a.prototype.setPosition=function(t){for(var e in t)this._coords[e]=t[e];this._update()},a.prototype.perspective=function(){return this._perspective},a.prototype.setPerspective=function(t){for(var e in t)this._perspective[e]=t[e];this._update()},a.prototype.show=function(){this._visible||(this._visible=!0,this._update())},a.prototype.hide=function(){this._visible&&(this._visible=!1,this._update())},a.prototype._update=function(){var t,e,n=this._domElement,r=this._coords,i=this._position,o=!1;if(this._visible){var s=this._view;this._perspective.radius?(o=!0,this._setEmbeddedPosition(s,r)):(s.coordinatesToScreen(r,i),t=i.x,e=i.y,null!=t&&null!=e&&(o=!0,this._setPosition(t,e)))}o?(n.style.display="block",n.style.position="absolute"):(n.style.display="none",n.style.position="")},a.prototype._setEmbeddedPosition=function(t,e){var n=t.coordinatesToPerspectiveTransform(e,this._perspective.radius,this._perspective.extraTransforms);o(this._domElement,n)},a.prototype._setPosition=function(t,e){i(this._domElement,t,e,this._perspective.extraTransforms)},t.exports=a},3561:function(t,e,n){"use strict";var r=n(5696),i=n(1154),o=n(6929),s=n(7691),a=n(6939).setAbsolute,h=n(6939).setOverflowHidden,u=n(6939).setOverflowVisible,c=n(6939).setNullSize,l=n(6939).setPixelSize,f=n(6939).setWithVendorPrefix("pointer-events"),p=n(6112);function d(t,e,n,r,i){i=i||{},this._parentDomElement=t,this._stage=e,this._view=n,this._renderLoop=r,this._hotspots=[],this._visible=!0,this._rect=i.rect,this._visibilityOrRectChanged=!0,this._stageWidth=null,this._stageHeight=null,this._tmpRect={},this._hotspotContainerWrapper=document.createElement("div"),a(this._hotspotContainerWrapper),f(this._hotspotContainerWrapper,"none"),this._parentDomElement.appendChild(this._hotspotContainerWrapper),this._hotspotContainer=document.createElement("div"),a(this._hotspotContainer),f(this._hotspotContainer,"all"),this._hotspotContainerWrapper.appendChild(this._hotspotContainer),this._updateHandler=this._update.bind(this),this._renderLoop.addEventListener("afterRender",this._updateHandler)}r(d),d.prototype.destroy=function(){for(;this._hotspots.length;)this.destroyHotspot(this._hotspots[0]);this._parentDomElement.removeChild(this._hotspotContainerWrapper),this._renderLoop.removeEventListener("afterRender",this._updateHandler),p(this)},d.prototype.domElement=function(){return this._hotspotContainer},d.prototype.setRect=function(t){this._rect=t,this._visibilityOrRectChanged=!0},d.prototype.rect=function(){return this._rect},d.prototype.createHotspot=function(t,e,n){e=e||{};var r=new i(t,this._hotspotContainer,this._view,e,n);return this._hotspots.push(r),r._update(),this.emit("hotspotsChange"),r},d.prototype.hasHotspot=function(t){return this._hotspots.indexOf(t)>=0},d.prototype.listHotspots=function(){return[].concat(this._hotspots)},d.prototype.destroyHotspot=function(t){var e=this._hotspots.indexOf(t);if(e<0)throw Error("No such hotspot");this._hotspots.splice(e,1),t.destroy(),this.emit("hotspotsChange")},d.prototype.hide=function(){this._visible&&(this._visible=!1,this._visibilityOrRectChanged=!0,this._update())},d.prototype.show=function(){this._visible||(this._visible=!0,this._visibilityOrRectChanged=!0,this._update())},d.prototype._update=function(){var t=this._hotspotContainerWrapper,e=this._stage.width(),n=this._stage.height(),r=this._tmpRect;if(this._visibilityOrRectChanged||this._rect&&(e!==this._stageWidth||n!==this._stageHeight)){var i=this._visible;t.style.display=i?"block":"none",i&&(this._rect?(o(e,n,this._rect,r),s(t,e*r.x,n*r.y),l(t,e*r.width,n*r.height),h(t)):(s(t,0,0),c(t),u(t))),this._stageWidth=e,this._stageHeight=n,this._visibilityOrRectChanged=!1}for(var a=0;a<this._hotspots.length;a++)this._hotspots[a]._update()},t.exports=d},4221:function(t,e,n){"use strict";var r=n(5696),i=n(8804),o=n(6112);function s(t,e,n,r,i){i=i||{};var o=this;this._source=t,this._geometry=e,this._view=n,this._textureStore=r,this._effects=i.effects||{},this._fixedLevelIndex=null,this._viewChangeHandler=function(){o.emit("viewChange",o.view())},this._view.addEventListener("change",this._viewChangeHandler),this._textureStoreChangeHandler=function(){o.emit("textureStoreChange",o.textureStore())},this._textureStore.addEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.addEventListener("textureInvalid",this._textureStoreChangeHandler)}r(s),s.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._textureStore.removeEventListener("textureLoad",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureError",this._textureStoreChangeHandler),this._textureStore.removeEventListener("textureInvalid",this._textureStoreChangeHandler),o(this)},s.prototype.source=function(){return this._source},s.prototype.geometry=function(){return this._geometry},s.prototype.view=function(){return this._view},s.prototype.textureStore=function(){return this._textureStore},s.prototype.effects=function(){return this._effects},s.prototype.setEffects=function(t){this._effects=t,this.emit("effectsChange",this._effects)},s.prototype.mergeEffects=function(t){i(this._effects,t),this.emit("effectsChange",this._effects)},s.prototype.fixedLevel=function(){return this._fixedLevelIndex},s.prototype.setFixedLevel=function(t){if(t!==this._fixedLevelIndex){if(null!=t&&(t>=this._geometry.levelList.length||t<0))throw Error("Level index out of range: "+t);this._fixedLevelIndex=t,this.emit("fixedLevelChange",this._fixedLevelIndex)}},s.prototype._selectLevel=function(){return null!=this._fixedLevelIndex?this._geometry.levelList[this._fixedLevelIndex]:this._view.selectLevel(this._geometry.selectableLevelList)},s.prototype.visibleTiles=function(t){var e=this._selectLevel();return this._geometry.visibleTiles(this._view,e,t)},s.prototype.pinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),r=0;r<n.length;r++)this._textureStore.pin(n[r])},s.prototype.unpinLevel=function(t){for(var e=this._geometry.levelList[t],n=this._geometry.levelTiles(e),r=0;r<n.length;r++)this._textureStore.unpin(n[r])},s.prototype.pinFirstLevel=function(){return this.pinLevel(0)},s.prototype.unpinFirstLevel=function(){return this.unpinLevel(0)},t.exports=s},3344:function(t,e,n){"use strict";function r(t){this.constructor.super_.apply(this,arguments),this.message=t}n(5003)(r,Error),t.exports=r},3036:function(t,e,n){"use strict";var r=n(5696),i=n(6112);function o(t){var e=this;this._stage=t,this._running=!1,this._rendering=!1,this._requestHandle=null,this._boundLoop=this._loop.bind(this),this._renderInvalidHandler=function(){e._rendering||e.renderOnNextFrame()},this._stage.addEventListener("renderInvalid",this._renderInvalidHandler)}r(o),o.prototype.destroy=function(){this.stop(),this._stage.removeEventListener("renderInvalid",this._renderInvalidHandler),i(this)},o.prototype.stage=function(){return this._stage},o.prototype.start=function(){this._running=!0,this.renderOnNextFrame()},o.prototype.stop=function(){this._requestHandle&&(window.cancelAnimationFrame(this._requestHandle),this._requestHandle=null),this._running=!1},o.prototype.renderOnNextFrame=function(){this._running&&!this._requestHandle&&(this._requestHandle=window.requestAnimationFrame(this._boundLoop))},o.prototype._loop=function(){if(!this._running)throw Error("Render loop running while in stopped state");this._requestHandle=null,this._rendering=!0,this.emit("beforeRender"),this._rendering=!1,this._stage.render(),this.emit("afterRender")},t.exports=o},5214:function(t,e,n){"use strict";var r=n(4221),i=n(7559),o=n(3561),s=n(5696),a=n(1227),h=n(3120),u=n(3969),c=n(9821),l=n(6112);function f(t,e){this._viewer=t,this._view=e,this._layers=[],this._hotspotContainer=new o(t._controlContainer,t.stage(),this._view,t.renderLoop()),this._movement=null,this._movementStartTime=null,this._movementStep=null,this._movementParams=null,this._movementCallback=null,this._updateMovementHandler=this._updateMovement.bind(this),this._updateHotspotContainerHandler=this._updateHotspotContainer.bind(this),this._viewer.addEventListener("sceneChange",this._updateHotspotContainerHandler),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._view.addEventListener("change",this._viewChangeHandler),this._updateHotspotContainer()}s(f),f.prototype.destroy=function(){this._view.removeEventListener("change",this._viewChangeHandler),this._viewer.removeEventListener("sceneChange",this._updateHotspotContainerHandler),this._movement&&this.stopMovement(),this._hotspotContainer.destroy(),this.destroyAllLayers(),l(this)},f.prototype.hotspotContainer=function(){return this._hotspotContainer},f.prototype.layer=function(){return this._layers[0]},f.prototype.listLayers=function(){return[].concat(this._layers)},f.prototype.view=function(){return this._view},f.prototype.viewer=function(){return this._viewer},f.prototype.visible=function(){return this._viewer.scene()===this},f.prototype.createLayer=function(t){var e=(t=t||{}).textureStoreOpts||{},n=t.layerOpts||{},o=t.source,s=t.geometry,a=this._view,h=this._viewer.stage(),u=new i(o,h,e),c=new r(o,s,a,u,n);return this._layers.push(c),t.pinFirstLevel&&c.pinFirstLevel(),this.emit("layerChange"),c},f.prototype.destroyLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw Error("No such layer in scene");this._layers.splice(e,1),this.emit("layerChange"),t.textureStore().destroy(),t.destroy()},f.prototype.destroyAllLayers=function(){for(;this._layers.length>0;)this.destroyLayer(this._layers[0])},f.prototype.switchTo=function(t,e){return this._viewer.switchScene(this,t,e)},f.prototype.lookTo=function(t,e,n){var r=this;if(e=e||{},n=n||h,"object"!==u(t))throw Error("Target view parameters must be an object");var i=null!=e.ease?e.ease:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},o=null!=e.controlsInterrupt&&e.controlsInterrupt,s=null!=e.transitionDuration?e.transitionDuration:1e3,a=null==e.shortest||e.shortest,l=this._view,f=l.parameters(),p={};c(p,t),c(p,f),a&&l.normalizeToClosest&&l.normalizeToClosest(p,p);var d=this._viewer.controls().enabled();o||this._viewer.controls().disable(),this.startMovement(function(){var t=!1;return function(e,n){if(n>=s&&t)return null;var r=Math.min(n/s,1);for(var o in e){var a=f[o],h=p[o];e[o]=a+i(r)*(h-a)}return t=n>=s,e}},function(){d&&r._viewer.controls().enable(),n()})},f.prototype.startMovement=function(t,e){var n=this._viewer.renderLoop();this._movement&&this.stopMovement();var r=t();if("function"!=typeof r)throw Error("Bad movement");this._movement=t,this._movementStep=r,this._movementStartTime=a(),this._movementParams={},this._movementCallback=e,n.addEventListener("beforeRender",this._updateMovementHandler),n.renderOnNextFrame()},f.prototype.stopMovement=function(){var t=this._movementCallback,e=this._viewer.renderLoop();this._movement&&(this._movement=null,this._movementStep=null,this._movementStartTime=null,this._movementParams=null,this._movementCallback=null,e.removeEventListener("beforeRender",this._updateMovementHandler),t&&t())},f.prototype.movement=function(){return this._movement},f.prototype._updateMovement=function(){if(!this._movement)throw Error("Should not call update");var t=this._viewer.renderLoop(),e=this._view,n=a()-this._movementStartTime,r=this._movementStep,i=this._movementParams;null==(i=r(i=e.parameters(i),n))?this.stopMovement():(e.setParameters(i),t.renderOnNextFrame())},f.prototype._updateHotspotContainer=function(){this.visible()?this._hotspotContainer.show():this._hotspotContainer.hide()},t.exports=f},7559:function(t,e,n){"use strict";var r=n(3180),i=n(5184),o=n(5290),s=n(5696),a=n(9821),h=n(2582),u=n(8111),c=n(5003),l=n(6112),f="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.textureStore,p={IDLE:0,START:1,MARK:2,END:3},d={previouslyVisibleCacheSize:512},v=0;function m(){}function _(t,e){var n=this,r=v++;n._id=r,n._store=t,n._tile=e,n._asset=null,n._texture=null,n._changeHandler=function(){t.emit("textureInvalid",e)};var i=t.source(),o=t.stage(),s=i.loadAsset.bind(i),a=o.createTexture.bind(o),c=u(h(s),a);t.emit("textureStartLoad",e),f&&console.log("loading",r,e),n._cancel=c(o,e,function(i,o,s,a){if(n._cancel=null,i){s&&s.destroy(),a&&a.destroy(),i instanceof m?(t.emit("textureCancel",e),f&&console.log("cancel",r,e)):(t.emit("textureError",e,i),f&&console.log("error",r,e));return}n._texture=a,s.isDynamic()?(n._asset=s,s.addEventListener("change",n._changeHandler)):s.destroy(),t.emit("textureLoad",e),f&&console.log("load",r,e)})}function y(t,e,n){n=a(n||{},d),this._source=t,this._stage=e,this._state=p.IDLE,this._delimCount=0,this._itemMap=new r,this._visible=new i,this._previouslyVisible=new o(n.previouslyVisibleCacheSize),this._pinMap=new r,this._newVisible=new i,this._noLongerVisible=[],this._visibleAgain=[],this._evicted=[]}c(m,Error),_.prototype.asset=function(){return this._asset},_.prototype.texture=function(){return this._texture},_.prototype.destroy=function(){var t=this._id,e=this._store,n=this._tile,r=this._asset,i=this._texture,o=this._cancel;if(o){o(new m("Texture load cancelled"));return}r&&(r.removeEventListener("change",this._changeHandler),r.destroy()),i&&i.destroy(),e.emit("textureUnload",n),f&&console.log("unload",t,n),l(this)},s(_),s(y),y.prototype.destroy=function(){this.clear(),l(this)},y.prototype.stage=function(){return this._stage},y.prototype.source=function(){return this._source},y.prototype.clear=function(){var t=this;t._evicted.length=0,t._itemMap.forEach(function(e){t._evicted.push(e)}),t._evicted.forEach(function(e){t._unloadTile(e)}),t._itemMap.clear(),t._visible.clear(),t._previouslyVisible.clear(),t._pinMap.clear(),t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},y.prototype.clearNotPinned=function(){var t=this;t._evicted.length=0,t._itemMap.forEach(function(e){t._pinMap.has(e)||t._evicted.push(e)}),t._evicted.forEach(function(e){t._unloadTile(e)}),t._visible.clear(),t._previouslyVisible.clear(),t._evicted.length=0},y.prototype.startFrame=function(){if(this._state!==p.IDLE&&this._state!==p.START)throw Error("TextureStore: startFrame called out of sequence");this._state=p.START,this._delimCount++},y.prototype.markTile=function(t){if(this._state!==p.START&&this._state!==p.MARK)throw Error("TextureStore: markTile called out of sequence");this._state=p.MARK;var e=this._itemMap.get(t),n=e&&e.texture(),r=e&&e.asset();n&&r&&n.refresh(t,r),this._newVisible.add(t)},y.prototype.endFrame=function(){if(this._state!==p.START&&this._state!==p.MARK&&this._state!==p.END)throw Error("TextureStore: endFrame called out of sequence");this._state=p.END,this._delimCount--,this._delimCount||(this._update(),this._state=p.IDLE)},y.prototype._update=function(){var t=this;t._noLongerVisible.length=0,t._visible.forEach(function(e){t._newVisible.has(e)||t._noLongerVisible.push(e)}),t._visibleAgain.length=0,t._newVisible.forEach(function(e){t._previouslyVisible.has(e)&&t._visibleAgain.push(e)}),t._visibleAgain.forEach(function(e){t._previouslyVisible.remove(e)}),t._evicted.length=0,t._noLongerVisible.forEach(function(e){var n=t._itemMap.get(e);if(n&&n.texture()){var r=t._previouslyVisible.add(e);null!=r&&t._evicted.push(r)}else n&&t._unloadTile(e)}),t._evicted.forEach(function(e){t._pinMap.has(e)||t._unloadTile(e)}),t._newVisible.forEach(function(e){t._itemMap.get(e)||t._loadTile(e)});var e=t._visible;t._visible=t._newVisible,t._newVisible=e,t._newVisible.clear(),t._noLongerVisible.length=0,t._visibleAgain.length=0,t._evicted.length=0},y.prototype._loadTile=function(t){if(this._itemMap.has(t))throw Error("TextureStore: loading texture already in cache");var e=new _(this,t);this._itemMap.set(t,e)},y.prototype._unloadTile=function(t){var e=this._itemMap.del(t);if(!e)throw Error("TextureStore: unloading texture not in cache");e.destroy()},y.prototype.asset=function(t){var e=this._itemMap.get(t);return e?e.asset():null},y.prototype.texture=function(t){var e=this._itemMap.get(t);return e?e.texture():null},y.prototype.pin=function(t){var e=(this._pinMap.get(t)||0)+1;return this._pinMap.set(t,e),this._itemMap.has(t)||this._loadTile(t),e},y.prototype.unpin=function(t){var e=this._pinMap.get(t);if(e)--e>0?this._pinMap.set(t,e):(this._pinMap.del(t),this._visible.has(t)||this._previouslyVisible.has(t)||this._unloadTile(t));else throw Error("TextureStore: unpin when not pinned");return e},y.prototype.query=function(t){var e=this._itemMap.get(t),n=this._pinMap.get(t)||0;return{visible:this._visible.has(t),previouslyVisible:this._previouslyVisible.has(t),hasAsset:null!=e&&null!=e.asset(),hasTexture:null!=e&&null!=e.texture(),pinned:0!==n,pinCount:n}},t.exports=y},6085:function(t,e,n){"use strict";var r=n(5184);function i(){this._stack=[],this._visited=new r,this._vertices=null}i.prototype.search=function(t,e,n){var r=this._stack,i=this._visited,o=this._vertices,s=0;for(this._clear(),r.push(e);r.length>0;){var a=r.pop();if(!i.has(a)&&t.intersects(a.vertices(o))){i.add(a);for(var h=a.neighbors(),u=0;u<h.length;u++)r.push(h[u]);n.push(a),s++}}return this._vertices=o,this._clear(),s},i.prototype._clear=function(){this._stack.length=0,this._visited.clear()},t.exports=i},9274:function(t,e,n){"use strict";var r=n(5696),i=n(9821),o=n(1227),s={duration:1/0};function a(t){t=i(t||{},s),this._duration=t.duration,this._startTime=null,this._handle=null,this._check=this._check.bind(this)}r(a),a.prototype.start=function(){this._startTime=o(),null==this._handle&&this._duration<1/0&&this._setup(this._duration)},a.prototype.started=function(){return null!=this._startTime},a.prototype.stop=function(){this._startTime=null,null!=this._handle&&(clearTimeout(this._handle),this._handle=null)},a.prototype._setup=function(t){this._handle=setTimeout(this._check,t)},a.prototype._teardown=function(){clearTimeout(this._handle),this._handle=null},a.prototype._check=function(){var t=o()-this._startTime,e=this._duration-t;this._teardown(),e<=0?(this.emit("timeout"),this._startTime=null):e<1/0&&this._setup(e)},a.prototype.duration=function(){return this._duration},a.prototype.setDuration=function(t){this._duration=t,null!=this._startTime&&this._check()},t.exports=a},7599:function(t,e,n){"use strict";var r=n(5696),i=n(3036),o=n(1839),s=n(5214),a=n(9274),h=n(5662),u=n(2569),c=n(8975),l=n(7895),f=n(1505),p=n(6939).setOverflowHidden,d=n(6939).setAbsolute,v=n(6939).setFullSize,m=n(5026),_=n(3120),y=n(6112);function g(t,e){e=e||{},this._domElement=t,p(t),this._stage=new h(e.stage),f(this._stage),this._domElement.appendChild(this._stage.domElement()),this._controlContainer=document.createElement("div"),d(this._controlContainer),v(this._controlContainer),t.appendChild(this._controlContainer),this._size={},this.updateSize(),this._updateSizeListener=this.updateSize.bind(this),window.addEventListener("resize",this._updateSizeListener),this._renderLoop=new i(this._stage),this._controls=new o,this._controlMethods=l(this._controls,this._controlContainer,e.controls),this._controls.attach(this._renderLoop),this._hammerManagerTouch=c.get(this._controlContainer,"touch"),this._hammerManagerMouse=c.get(this._controlContainer,"mouse"),this._dragCursor=new u(this._controls,"mouseViewDrag",t,e.cursors&&e.cursors.drag||{}),this._renderLoop.start(),this._scenes=[],this._currentScene=null,this._replacedScene=null,this._cancelCurrentTween=null,this._layerChangeHandler=this._updateSceneLayers.bind(this),this._viewChangeHandler=this.emit.bind(this,"viewChange"),this._idleTimer=new a,this._idleTimer.start(),this._resetIdleTimerHandler=this._resetIdleTimer.bind(this),this.addEventListener("viewChange",this._resetIdleTimerHandler),this._triggerIdleTimerHandler=this._triggerIdleTimer.bind(this),this._idleTimer.addEventListener("timeout",this._triggerIdleTimerHandler),this._stopMovementHandler=this.stopMovement.bind(this),this._controls.addEventListener("active",this._stopMovementHandler),this.addEventListener("sceneChange",this._stopMovementHandler),this._idleMovement=null}function M(t,e,n){e.listLayers().forEach(function(e){e.mergeEffects({opacity:t})}),e._hotspotContainer.domElement().style.opacity=t}r(g),g.prototype.destroy=function(){for(var t in window.removeEventListener("resize",this._updateSizeListener),this._currentScene&&this._removeSceneEventListeners(this._currentScene),this._replacedScene&&this._removeSceneEventListeners(this._replacedScene),this._dragCursor.destroy(),this._controlMethods)this._controlMethods[t].destroy();for(;this._scenes.length;)this.destroyScene(this._scenes[0]);this._domElement.removeChild(this._stage.domElement()),this._stage.destroy(),this._renderLoop.destroy(),this._controls.destroy(),this._controls=null,this._cancelCurrentTween&&this._cancelCurrentTween(),y(this)},g.prototype.updateSize=function(){var t=this._size;t.width=this._domElement.clientWidth,t.height=this._domElement.clientHeight,this._stage.setSize(t)},g.prototype.stage=function(){return this._stage},g.prototype.renderLoop=function(){return this._renderLoop},g.prototype.controls=function(){return this._controls},g.prototype.domElement=function(){return this._domElement},g.prototype.createScene=function(t){t=t||{};var e=this.createEmptyScene({view:t.view});return e.createLayer({source:t.source,geometry:t.geometry,pinFirstLevel:t.pinFirstLevel,textureStoreOpts:t.textureStoreOpts,layerOpts:t.layerOpts}),e},g.prototype.createEmptyScene=function(t){t=t||{};var e=new s(this,t.view);return this._scenes.push(e),e},g.prototype._updateSceneLayers=function(){var t,e,n=this._stage,r=this._currentScene,i=this._replacedScene,o=n.listLayers(),s=[];if(i&&(s=s.concat(i.listLayers())),r&&(s=s.concat(r.listLayers())),1!==Math.abs(o.length-s.length))throw Error("Stage and scene out of sync");if(s.length<o.length){for(t=0;t<o.length;t++)if(e=o[t],0>s.indexOf(e)){this._removeLayerFromStage(e);break}}if(s.length>o.length)for(t=0;t<s.length;t++)e=s[t],0>o.indexOf(e)&&this._addLayerToStage(e,t)},g.prototype._addLayerToStage=function(t,e){t.pinFirstLevel(),this._stage.addLayer(t,e)},g.prototype._removeLayerFromStage=function(t){this._stage.removeLayer(t),t.unpinFirstLevel(),t.textureStore().clearNotPinned()},g.prototype._addSceneEventListeners=function(t){t.addEventListener("layerChange",this._layerChangeHandler),t.addEventListener("viewChange",this._viewChangeHandler)},g.prototype._removeSceneEventListeners=function(t){t.removeEventListener("layerChange",this._layerChangeHandler),t.removeEventListener("viewChange",this._viewChangeHandler)},g.prototype.destroyScene=function(t){var e,n,r=this._scenes.indexOf(t);if(r<0)throw Error("No such scene in viewer");if(this._currentScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null),this._currentScene=null,this.emit("sceneChange")}if(this._replacedScene===t){for(this._removeSceneEventListeners(t),n=t.listLayers(),e=0;e<n.length;e++)this._removeLayerFromStage(n[e]);this._replacedScene=null}this._scenes.splice(r,1),t.destroy()},g.prototype.destroyAllScenes=function(){for(;this._scenes.length>0;)this.destroyScene(this._scenes[0])},g.prototype.hasScene=function(t){return this._scenes.indexOf(t)>=0},g.prototype.listScenes=function(){return[].concat(this._scenes)},g.prototype.scene=function(){return this._currentScene},g.prototype.view=function(){var t=this._currentScene;return t?t.view():null},g.prototype.lookTo=function(t,e,n){var r=this._currentScene;r&&r.lookTo(t,e,n)},g.prototype.startMovement=function(t,e){var n=this._currentScene;n&&n.startMovement(t,e)},g.prototype.stopMovement=function(){var t=this._currentScene;t&&t.stopMovement()},g.prototype.movement=function(){var t=this._currentScene;if(t)return t.movement()},g.prototype.setIdleMovement=function(t,e){this._idleTimer.setDuration(t),this._idleMovement=e},g.prototype.breakIdleMovement=function(){this.stopMovement(),this._resetIdleTimer()},g.prototype._resetIdleTimer=function(){this._idleTimer.start()},g.prototype._triggerIdleTimer=function(){var t=this._idleMovement;t&&this.startMovement(t)},g.prototype.switchScene=function(t,e,n){var r=this;e=e||{},n=n||_;var i=this._stage,o=this._currentScene;if(o===t){n();return}if(0>this._scenes.indexOf(t))throw Error("No such scene in viewer");this._cancelCurrentTween&&(this._cancelCurrentTween(),this._cancelCurrentTween=null);var s=o?o.listLayers():[],a=t.listLayers(),h=i.listLayers();if(o&&(h.length!==s.length||h.length>1&&h[0]!=s[0]))throw Error("Stage not in sync with viewer");for(var u=null!=e.transitionDuration?e.transitionDuration:1e3,c=null!=e.transitionUpdate?e.transitionUpdate:M,l=0;l<a.length;l++)this._addLayerToStage(a[l]);this._cancelCurrentTween=m(u,function(e){c(e,t,o)},function(){if(r._replacedScene){r._removeSceneEventListeners(r._replacedScene),s=r._replacedScene.listLayers();for(var t=0;t<s.length;t++)r._removeLayerFromStage(s[t]);r._replacedScene=null}r._cancelCurrentTween=null,n()}),this._currentScene=t,this._replacedScene=o,this.emit("sceneChange"),this.emit("viewChange"),this._addSceneEventListeners(t)},t.exports=g},3909:function(t,e,n){"use strict";var r=n(3188),i=n(5003),o=n(5696),s=n(6112);function a(t){this.constructor.super_.call(this,t),this._timestamp=0}i(a,r),o(a),a.prototype.destroy=function(){s(this)},a.prototype.timestamp=function(){return this._timestamp},a.prototype.isDynamic=function(){return!0},a.prototype.markDirty=function(){this._timestamp++,this.emit("change")},t.exports=a},3188:function(t,e,n){"use strict";var r=n(5135),i=n(5696),o=n(6112),s={HTMLImageElement:["naturalWidth","naturalHeight"],HTMLCanvasElement:["width","height"],ImageBitmap:["width","height"]};function a(t){var e=!1;for(var n in s)if(r[n]&&t instanceof r[n]){e=!0,this._widthProp=s[n][0],this._heightProp=s[n][1];break}if(!e)throw Error("Unsupported pixel source");this._element=t}i(a),a.prototype.destroy=function(){o(this)},a.prototype.element=function(){return this._element},a.prototype.width=function(){return this._element[this._widthProp]},a.prototype.height=function(){return this._element[this._heightProp]},a.prototype.timestamp=function(){return 0},a.prototype.isDynamic=function(){return!1},t.exports=a},4273:function(t,e,n){"use strict";var r=n(9821),i={yawSpeed:.1,pitchSpeed:.1,fovSpeed:.1,yawAccel:.01,pitchAccel:.01,fovAccel:.01,targetPitch:0,targetFov:null};t.exports=function(t){var e=(t=r(t||{},i)).yawSpeed,n=t.pitchSpeed,o=t.fovSpeed,s=t.yawAccel,a=t.pitchAccel,h=t.fovAccel,u=t.targetPitch,c=t.targetFov;return function(){var t,r,i,l,f=0,p=0,d=0,v=0,m=0,_=0,y=0;return function(g,M){if(r=(m=Math.min(p+(t=(M-f)/1e3)*s,e))*t,g.yaw=g.yaw+r,null!=u&&g.pitch!==u){var w=.5*d*d/a;i=(_=Math.abs(u-g.pitch)>w?Math.min(d+t*a,n):Math.max(d-t*a,0))*t,u<g.pitch&&(g.pitch=Math.max(u,g.pitch-i)),u>g.pitch&&(g.pitch=Math.min(u,g.pitch+i))}if(null!=c&&g.fov!==u){var x=.5*v*v/h;l=(y=Math.abs(c-g.fov)>x?Math.min(v+t*h,o):Math.max(v-t*h,0))*t,c<g.fov&&(g.fov=Math.max(c,g.fov-l)),c>g.fov&&(g.fov=Math.min(c,g.fov+l))}return f=M,p=m,d=_,v=y,g}}}},46:function(t,e,n){"use strict";var r=n(8001);function i(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw Error("LruMap: invalid capacity");this._capacity=t,this._keys=Array(this._capacity),this._values=Array(this._capacity),this._start=0,this._size=0}i.prototype._index=function(t){return r(this._start+t,this._capacity)},i.prototype.get=function(t){for(var e=0;e<this._size;e++){var n=this._keys[this._index(e)];if(t.equals(n))return this._values[this._index(e)]}return null},i.prototype.set=function(t,e){if(0===this._capacity)return t;this.del(t);var n=this._size===this._capacity?this._keys[this._index(0)]:null;return this._keys[this._index(this._size)]=t,this._values[this._index(this._size)]=e,this._size<this._capacity?this._size++:this._start=this._index(1),n},i.prototype.del=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)])){for(var n=this._values[this._index(e)],r=e;r<this._size-1;r++)this._keys[this._index(r)]=this._keys[this._index(r+1)],this._values[this._index(r)]=this._values[this._index(r+1)];return this._size--,n}return null},i.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._keys[this._index(e)]))return!0;return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._start=0,this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._keys[this._index(n)],this._values[this._index(n)]),e+=1;return e},t.exports=i},5290:function(t,e,n){"use strict";var r=n(8001);function i(t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw Error("LruSet: invalid capacity");this._capacity=t,this._elements=Array(this._capacity),this._start=0,this._size=0}i.prototype._index=function(t){return r(this._start+t,this._capacity)},i.prototype.add=function(t){if(0===this._capacity)return t;this.remove(t);var e=this._size===this._capacity?this._elements[this._index(0)]:null;return this._elements[this._index(this._size)]=t,this._size<this._capacity?this._size++:this._start=this._index(1),e},i.prototype.remove=function(t){for(var e=0;e<this._size;e++){var n=this._elements[this._index(e)];if(t.equals(n)){for(var r=e;r<this._size-1;r++)this._elements[this._index(r)]=this._elements[this._index(r+1)];return this._size--,n}}return null},i.prototype.has=function(t){for(var e=0;e<this._size;e++)if(t.equals(this._elements[this._index(e)]))return!0;return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._elements.length=0,this._start=0,this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._size;n++)t(this._elements[this._index(n)]),e+=1;return e},t.exports=i},3180:function(t,e,n){"use strict";var r=n(8001);function i(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw Error("Map: invalid capacity");this._capacity=t||64,this._keyBuckets=[],this._valBuckets=[];for(var e=0;e<this._capacity;e++)this._keyBuckets.push([]),this._valBuckets.push([]);this._size=0}i.prototype.get=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return this._valBuckets[e][i]}return null},i.prototype.set=function(t,e){for(var n=r(t.hash(),this._capacity),i=this._keyBuckets[n],o=this._valBuckets[n],s=0;s<i.length;s++){var a=i[s];if(t.equals(a)){var h=o[s];return i[s]=t,o[s]=e,h}}return i.push(t),o.push(e),this._size++,null},i.prototype.del=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=this._valBuckets[e],o=0;o<n.length;o++){var s=n[o];if(t.equals(s)){for(var a=i[o],h=o;h<n.length-1;h++)n[h]=n[h+1],i[h]=i[h+1];return n.length=n.length-1,i.length=i.length-1,this._size--,a}}return null},i.prototype.has=function(t){for(var e=r(t.hash(),this._capacity),n=this._keyBuckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return!0}return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._keyBuckets[t].length=0,this._valBuckets[t].length=0;this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var r=this._keyBuckets[n],i=this._valBuckets[n],o=0;o<r.length;o++)t(r[o],i[o]),e+=1;return e},t.exports=i},5184:function(t,e,n){"use strict";var r=n(8001);function i(t){if(null!=t&&(!isFinite(t)||Math.floor(t)!==t||t<1))throw Error("Set: invalid capacity");this._capacity=this._capacity||64,this._buckets=[];for(var e=0;e<this._capacity;e++)this._buckets.push([]);this._size=0}i.prototype.add=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return n[i]=t,o}return n.push(t),this._size++,null},i.prototype.remove=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o)){for(var s=i;s<n.length-1;s++)n[s]=n[s+1];return n.length=n.length-1,this._size--,o}}return null},i.prototype.has=function(t){for(var e=r(t.hash(),this._capacity),n=this._buckets[e],i=0;i<n.length;i++){var o=n[i];if(t.equals(o))return!0}return!1},i.prototype.size=function(){return this._size},i.prototype.clear=function(){for(var t=0;t<this._capacity;t++)this._buckets[t].length=0;this._size=0},i.prototype.forEach=function(t){for(var e=0,n=0;n<this._capacity;n++)for(var r=this._buckets[n],i=0;i<r.length;i++)t(r[i]),e+=1;return e},t.exports=i},2604:function(t,e,n){"use strict";var r=n(8585),i=n(8001);function o(t){this._concurrency=t&&t.concurrency||1,this._paused=t&&!!t.paused||!1,this._pool=[];for(var e=0;e<this._concurrency;e++)this._pool.push(new r(t));this._next=0}o.prototype.length=function(){for(var t=0,e=0;e<this._pool.length;e++)t+=this._pool[e].length();return t},o.prototype.push=function(t,e){var n=this._next,r=this._pool[n].push(t,e);return this._next=i(this._next+1,this._concurrency),r},o.prototype.pause=function(){if(!this._paused){this._paused=!0;for(var t=0;t<this._concurrency;t++)this._pool[t].pause()}},o.prototype.resume=function(){if(this._paused){this._paused=!1;for(var t=0;t<this._concurrency;t++)this._pool[t].resume()}},t.exports=o},8585:function(t,e,n){"use strict";var r=n(1227);function i(t,e){this.fn=t,this.cb=e,this.cfn=null}function o(t){this._queue=[],this._delay=t&&t.delay||0,this._paused=t&&!!t.paused||!1,this._currentTask=null,this._lastFinished=null}o.prototype.length=function(){return this._queue.length},o.prototype.push=function(t,e){var n=new i(t,e),r=this._cancel.bind(this,n);return this._queue.push(n),this._next(),r},o.prototype.pause=function(){this._paused||(this._paused=!0)},o.prototype.resume=function(){this._paused&&(this._paused=!1,this._next())},o.prototype._start=function(t){if(this._currentTask)throw Error("WorkQueue: called start while running task");this._currentTask=t;var e=this._finish.bind(this,t);if(t.cfn=t.fn(e),"function"!=typeof t.cfn)throw Error("WorkQueue: function is not cancellable")},o.prototype._finish=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask!==t)throw Error("WorkQueue: called finish on wrong task");t.cb.apply(null,e),this._currentTask=null,this._lastFinished=r(),this._next()},o.prototype._cancel=function(t){var e=Array.prototype.slice.call(arguments,1);if(this._currentTask===t)t.cfn.apply(null,e);else{var n=this._queue.indexOf(t);n>=0&&(this._queue.splice(n,1),t.cb.apply(null,e))}},o.prototype._next=function(){if(!this._paused&&this._queue.length&&!this._currentTask){if(null!=this._lastFinished){var t=r()-this._lastFinished,e=this._delay-t;if(e>0){setTimeout(this._next.bind(this),e);return}}var n=this._queue.shift();this._start(n)}},t.exports=o},8842:function(t,e,n){"use strict";var r=n(5994).vec4,i=n(5994).mat4;function o(t,e,n){var i,o,s,a,h,u;i=n,o=e.colorMatrix,s=t[0],a=t[1],h=t[2],u=t[3],i[0]=o[0]*s+o[1]*a+o[2]*h+o[3]*u,i[1]=o[4]*s+o[5]*a+o[6]*h+o[7]*u,i[2]=o[8]*s+o[9]*a+o[10]*h+o[11]*u,i[3]=o[12]*s+o[13]*a+o[14]*h+o[15]*u,r.add(n,n,e.colorOffset)}var s=r.create();t.exports={identity:function(t){var e=t||{};return e.colorOffset=e.colorOffset||r.create(),e.colorMatrix=e.colorMatrix||i.create(),e},applyToPixel:o,applyToImageData:function(t,e){for(var n=t.width,i=t.height,a=t.data,h=0;h<n*i;h++)r.set(s,a[4*h+0]/255,a[4*h+1]/255,a[4*h+2]/255,a[4*h+3]/255),o(s,e,s),a[4*h+0]=255*s[0],a[4*h+1]=255*s[1],a[4*h+2]=255*s[2],a[4*h+3]=255*s[3]}}},6279:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(1227),s=n(6112);function a(t){t=t||{},this._methods=[],this._parameters=["x","y","axisScaledX","axisScaledY","zoom","yaw","pitch","roll"],this._now=t.nowForTesting||o,this._composedOffsets={},this._composeReturn={offsets:this._composedOffsets,changing:null}}r(a),a.prototype.add=function(t){if(!this.has(t)){var e={};this._parameters.forEach(function(t){e[t]={dynamics:new i,time:null}});var n=this._updateDynamics.bind(this,e);t.addEventListener("parameterDynamics",n),this._methods.push({instance:t,dynamics:e,parameterDynamicsHandler:n})}},a.prototype.remove=function(t){var e=this._indexOfInstance(t);if(e>=0){var n=this._methods.splice(e,1)[0];n.instance.removeEventListener("parameterDynamics",n.parameterDynamicsHandler)}},a.prototype.has=function(t){return this._indexOfInstance(t)>=0},a.prototype._indexOfInstance=function(t){for(var e=0;e<this._methods.length;e++)if(this._methods[e].instance===t)return e;return -1},a.prototype.list=function(){for(var t=[],e=0;e<this._methods.length;e++)t.push(this._methods[e].instance);return t},a.prototype._updateDynamics=function(t,e,n){var r=t[e];if(!r)throw Error("Unknown control parameter "+e);var i=this._now();r.dynamics.update(n,(i-r.time)/1e3),r.time=i,this.emit("change")},a.prototype._resetComposedOffsets=function(){for(var t=0;t<this._parameters.length;t++)this._composedOffsets[this._parameters[t]]=0},a.prototype.offsets=function(){var t,e=!1,n=this._now();this._resetComposedOffsets();for(var r=0;r<this._methods.length;r++)for(var i=this._methods[r].dynamics,o=0;o<this._parameters.length;o++){var s=i[t=this._parameters[o]],a=s.dynamics;null!=a.offset&&(this._composedOffsets[t]+=a.offset,a.offset=null);var h=(n-s.time)/1e3,u=a.offsetFromVelocity(h);u&&(this._composedOffsets[t]+=u);var c=a.velocityAfter(h);a.velocity=c,c&&(e=!0),s.time=n}return this._composeReturn.changing=e,this._composeReturn},a.prototype.destroy=function(){for(var t=this.list(),e=0;e<t.length;e++)this.remove(t[e]);s(this)},t.exports=a},2569:function(t,e,n){"use strict";var r=n(9821),i=n(6112),o={active:"move",inactive:"default",disabled:"default"};function s(t,e,n,i){i=r(i||{},o),this._element=n,this._controls=t,this._id=e,this._attached=!1,this._setActiveCursor=this._setCursor.bind(this,i.active),this._setInactiveCursor=this._setCursor.bind(this,i.inactive),this._setDisabledCursor=this._setCursor.bind(this,i.disabled),this._setOriginalCursor=this._setCursor.bind(this,this._element.style.cursor),this._updateAttachmentHandler=this._updateAttachment.bind(this),t.addEventListener("methodEnabled",this._updateAttachmentHandler),t.addEventListener("methodDisabled",this._updateAttachmentHandler),t.addEventListener("enabled",this._updateAttachmentHandler),t.addEventListener("disabled",this._updateAttachmentHandler),this._updateAttachment()}s.prototype.destroy=function(){this._detachFromControlMethod(this._controls.method(this._id)),this._setOriginalCursor(),this._controls.removeEventListener("methodEnabled",this._updateAttachmentHandler),this._controls.removeEventListener("methodDisabled",this._updateAttachmentHandler),this._controls.removeEventListener("enabled",this._updateAttachmentHandler),this._controls.removeEventListener("disabled",this._updateAttachmentHandler),i(this)},s.prototype._updateAttachment=function(){var t=this._controls,e=this._id;t.enabled()&&t.method(e).enabled?this._attachToControlMethod(t.method(e)):this._detachFromControlMethod(t.method(e))},s.prototype._attachToControlMethod=function(t){this._attached||(t.instance.addEventListener("active",this._setActiveCursor),t.instance.addEventListener("inactive",this._setInactiveCursor),t.active?this._setActiveCursor():this._setInactiveCursor(),this._attached=!0)},s.prototype._detachFromControlMethod=function(t){this._attached&&(t.instance.removeEventListener("active",this._setActiveCursor),t.instance.removeEventListener("inactive",this._setInactiveCursor),this._setDisabledCursor(),this._attached=!1)},s.prototype._setCursor=function(t){this._element.style.cursor=t},t.exports=s},1839:function(t,e,n){"use strict";var r=n(5696),i=n(6279),o=n(6112),s="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function a(t){t=t||{},this._methods={},this._methodGroups={},this._composer=new i,this._enabled=!t||!t.enabled||!!t.enabled,this._activeCount=0,this.updatedViews_=[],this._attachedRenderLoop=null}r(a),a.prototype.destroy=function(){this.detach(),this._composer.destroy(),o(this)},a.prototype.methods=function(){var t={};for(var e in this._methods)t[e]=this._methods[e];return t},a.prototype.method=function(t){return this._methods[t]},a.prototype.registerMethod=function(t,e,n){if(this._methods[t])throw Error("Control method already registered with id "+t);this._methods[t]={instance:e,enabled:!1,active:!1,activeHandler:this._handleActive.bind(this,t),inactiveHandler:this._handleInactive.bind(this,t)},n&&this.enableMethod(t,e)},a.prototype.unregisterMethod=function(t){var e=this._methods[t];if(!e)throw Error("No control method registered with id "+t);e.enabled&&this.disableMethod(t),delete this._methods[t]},a.prototype.enableMethod=function(t){var e=this._methods[t];if(!e)throw Error("No control method registered with id "+t);e.enabled||(e.enabled=!0,e.active&&this._incrementActiveCount(),this._listen(t),this._updateComposer(),this.emit("methodEnabled",t))},a.prototype.disableMethod=function(t){var e=this._methods[t];if(!e)throw Error("No control method registered with id "+t);e.enabled&&(e.enabled=!1,e.active&&this._decrementActiveCount(),this._unlisten(t),this._updateComposer(),this.emit("methodDisabled",t))},a.prototype.addMethodGroup=function(t,e){this._methodGroups[t]=e},a.prototype.removeMethodGroup=function(t){delete this._methodGroups[t]},a.prototype.methodGroups=function(){var t={};for(var e in this._methodGroups)t[e]=this._methodGroups[e];return t},a.prototype.enableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach(function(t){e.enableMethod(t)})},a.prototype.disableMethodGroup=function(t){var e=this;e._methodGroups[t].forEach(function(t){e.disableMethod(t)})},a.prototype.enabled=function(){return this._enabled},a.prototype.enable=function(){this._enabled||(this._enabled=!0,this._activeCount>0&&this.emit("active"),this.emit("enabled"),this._updateComposer())},a.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._activeCount>0&&this.emit("inactive"),this.emit("disabled"),this._updateComposer())},a.prototype.attach=function(t){this._attachedRenderLoop&&this.detach(),this._attachedRenderLoop=t,this._beforeRenderHandler=this._updateViewsWithControls.bind(this),this._changeHandler=t.renderOnNextFrame.bind(t),this._attachedRenderLoop.addEventListener("beforeRender",this._beforeRenderHandler),this._composer.addEventListener("change",this._changeHandler)},a.prototype.detach=function(){this._attachedRenderLoop&&(this._attachedRenderLoop.removeEventListener("beforeRender",this._beforeRenderHandler),this._composer.removeEventListener("change",this._changeHandler),this._beforeRenderHandler=null,this._changeHandler=null,this._attachedRenderLoop=null)},a.prototype.attached=function(){return null!=this._attachedRenderLoop},a.prototype._listen=function(t){var e=this._methods[t];if(!e)throw Error("Bad method id");e.instance.addEventListener("active",e.activeHandler),e.instance.addEventListener("inactive",e.inactiveHandler)},a.prototype._unlisten=function(t){var e=this._methods[t];if(!e)throw Error("Bad method id");e.instance.removeEventListener("active",e.activeHandler),e.instance.removeEventListener("inactive",e.inactiveHandler)},a.prototype._handleActive=function(t){var e=this._methods[t];if(!e)throw Error("Bad method id");if(!e.enabled)throw Error("Should not receive event from disabled control method");e.active||(e.active=!0,this._incrementActiveCount())},a.prototype._handleInactive=function(t){var e=this._methods[t];if(!e)throw Error("Bad method id");if(!e.enabled)throw Error("Should not receive event from disabled control method");e.active&&(e.active=!1,this._decrementActiveCount())},a.prototype._incrementActiveCount=function(){this._activeCount++,s&&this._checkActiveCount(),this._enabled&&1===this._activeCount&&this.emit("active")},a.prototype._decrementActiveCount=function(){this._activeCount--,s&&this._checkActiveCount(),this._enabled&&0===this._activeCount&&this.emit("inactive")},a.prototype._checkActiveCount=function(){var t=0;for(var e in this._methods){var n=this._methods[e];n.enabled&&n.active&&t++}if(t!=this._activeCount)throw Error("Bad control state")},a.prototype._updateComposer=function(){var t=this._composer;for(var e in this._methods){var n=this._methods[e],r=this._enabled&&n.enabled;r&&!t.has(n.instance)&&t.add(n.instance),!r&&t.has(n.instance)&&t.remove(n.instance)}},a.prototype._updateViewsWithControls=function(){var t=this._composer.offsets();t.changing&&this._attachedRenderLoop.renderOnNextFrame(),this.updatedViews_.length=0;for(var e=this._attachedRenderLoop.stage().listLayers(),n=0;n<e.length;n++){var r=e[n].view();0>this.updatedViews_.indexOf(r)&&(e[n].view().updateWithControlParameters(t.offsets),this.updatedViews_.push(r))}},t.exports=a},9869:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(9821),a=n(958).maxFriction,h=n(6112),u={friction:6,maxFrictionTime:.3,hammerEvent:"pan"},c="undefined"!=typeof MARZIPANODEBUG&&MARZIPANODEBUG.controls;function l(t,e,n){if(this._element=t,this._opts=s(n||{},u),this._startEvent=null,this._lastEvent=null,this._active=!1,this._dynamics={x:new i,y:new i},this._hammer=o.get(t,e),this._hammer.on("hammer.input",this._handleHammerEvent.bind(this)),"pan"!=this._opts.hammerEvent&&"pinch"!=this._opts.hammerEvent)throw Error(this._opts.hammerEvent+" is not a hammerEvent managed in DragControlMethod");this._hammer.on(this._opts.hammerEvent+"start",this._handleStart.bind(this)),this._hammer.on(this._opts.hammerEvent+"move",this._handleMove.bind(this)),this._hammer.on(this._opts.hammerEvent+"end",this._handleEnd.bind(this)),this._hammer.on(this._opts.hammerEvent+"cancel",this._handleEnd.bind(this))}r(l),l.prototype.destroy=function(){this._hammer.release(),h(this)},l.prototype._handleHammerEvent=function(t){if(t.isFirst){if(c&&this._active)throw Error("DragControlMethod active detected when already active");this._active=!0,this.emit("active")}if(t.isFinal){if(c&&!this._active)throw Error("DragControlMethod inactive detected when already inactive");this._active=!1,this.emit("inactive")}},l.prototype._handleStart=function(t){t.preventDefault(),this._startEvent=t},l.prototype._handleMove=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsMove(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y))},l.prototype._handleEnd=function(t){t.preventDefault(),this._startEvent&&(this._updateDynamicsRelease(t),this.emit("parameterDynamics","axisScaledX",this._dynamics.x),this.emit("parameterDynamics","axisScaledY",this._dynamics.y)),this._startEvent=!1,this._lastEvent=!1},l.prototype._updateDynamicsMove=function(t){var e=t.deltaX,n=t.deltaY,r=this._lastEvent||this._startEvent;r&&(e-=r.deltaX,n-=r.deltaY);var i=this._element.getBoundingClientRect(),o=i.right-i.left,s=i.bottom-i.top;e/=o,n/=s,this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.offset=-e,this._dynamics.y.offset=-n,this._lastEvent=t};var f=[null,null];l.prototype._updateDynamicsRelease=function(t){var e=this._element.getBoundingClientRect(),n=e.right-e.left,r=e.bottom-e.top,i=1e3*t.velocityX/n,o=1e3*t.velocityY/r;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=i,this._dynamics.y.velocity=o,a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,f),this._dynamics.x.friction=f[0],this._dynamics.y.friction=f[1]},t.exports=l},4301:function(t){"use strict";function e(){this.velocity=null,this.friction=null,this.offset=null}e.equals=function(t,e){return t.velocity===e.velocity&&t.friction===e.friction&&t.offset===e.offset},e.prototype.equals=function(t){return e.equals(this,t)},e.prototype.update=function(t,e){t.offset&&(this.offset=this.offset||0,this.offset+=t.offset);var n=this.offsetFromVelocity(e);n&&(this.offset=this.offset||0,this.offset+=n),this.velocity=t.velocity,this.friction=t.friction},e.prototype.reset=function(){this.velocity=null,this.friction=null,this.offset=null},e.prototype.velocityAfter=function(t){var e,n;return this.velocity?this.friction?(e=this.velocity,n=this.friction*t,e<0?Math.min(0,e+n):e>0?Math.max(0,e-n):0):this.velocity:null},e.prototype.offsetFromVelocity=function(t){t=Math.min(t,this.nullVelocityTime());var e=this.velocityAfter(t);return(this.velocity+e)/2*t},e.prototype.nullVelocityTime=function(){return null==this.velocity?0:this.velocity&&!this.friction?1/0:Math.abs(this.velocity/this.friction)},t.exports=e},6067:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t,e,n,r){if(!t)throw Error("ElementPressControlMethod: element must be defined");if(!e)throw Error("ElementPressControlMethod: parameter must be defined");if(!n)throw Error("ElementPressControlMethod: velocity must be defined");if(!r)throw Error("ElementPressControlMethod: friction must be defined");this._element=t,this._pressHandler=this._handlePress.bind(this),this._releaseHandler=this._handleRelease.bind(this),t.addEventListener("mousedown",this._pressHandler),t.addEventListener("mouseup",this._releaseHandler),t.addEventListener("mouseleave",this._releaseHandler),t.addEventListener("touchstart",this._pressHandler),t.addEventListener("touchmove",this._releaseHandler),t.addEventListener("touchend",this._releaseHandler),this._parameter=e,this._velocity=n,this._friction=r,this._dynamics=new i,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("mousedown",this._pressHandler),this._element.removeEventListener("mouseup",this._releaseHandler),this._element.removeEventListener("mouseleave",this._releaseHandler),this._element.removeEventListener("touchstart",this._pressHandler),this._element.removeEventListener("touchmove",this._releaseHandler),this._element.removeEventListener("touchend",this._releaseHandler),o(this)},s.prototype._handlePress=function(){this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active")},s.prototype._handleRelease=function(){this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1},t.exports=s},8975:function(t,e,n){"use strict";var r=n(840),i=1,o="MarzipanoHammerElementId";function s(t,e){return t[o]||(t[o]=i++),e+t[o]}function a(){this._managers={},this._refCount={}}function h(t,e,n,r){this._manager=e,this._element=n,this._type=r,this._hammerGestures=t,this._eventHandlers=[]}a.prototype.get=function(t,e){var n=s(t,e);return this._managers[n]||(this._managers[n]=this._createManager(t,e),this._refCount[n]=0),this._refCount[n]++,new h(this,this._managers[n],t,e)},a.prototype._createManager=function(t,e){var n=new r.Manager(t);return"mouse"===e?n.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:0})):("touch"===e||"pen"===e||"kinect"===e)&&(n.add(new r.Pan({direction:r.DIRECTION_ALL,threshold:20,pointers:1})),n.add(new r.Pinch)),n},a.prototype._releaseHandle=function(t,e){var n=s(t,e);this._refCount[n]&&(this._refCount[n]--,this._refCount[n]||(this._managers[n].destroy(),delete this._managers[n],delete this._refCount[n]))},h.prototype.on=function(t,e){var n=this._type,r=function(t){n===t.pointerType&&e(t)};this._eventHandlers.push({events:t,handler:r}),this._manager.on(t,r)},h.prototype.release=function(){for(var t=0;t<this._eventHandlers.length;t++){var e=this._eventHandlers[t];this._manager.off(e.events,e.handler)}this._hammerGestures._releaseHandle(this._element,this._type),this._manager=null,this._element=null,this._type=null,this._hammerGestures=null},h.prototype.manager=function(){return this._manager},t.exports=new a},3939:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t,e,n,r,o){if(!t)throw Error("KeyControlMethod: keyCode must be defined");if(!e)throw Error("KeyControlMethod: parameter must be defined");if(!n)throw Error("KeyControlMethod: velocity must be defined");if(!r)throw Error("KeyControlMethod: friction must be defined");o=o||document,this._keyCode=t,this._parameter=e,this._velocity=n,this._friction=r,this._element=o,this._keydownHandler=this._handlePress.bind(this),this._keyupHandler=this._handleRelease.bind(this),this._blurHandler=this._handleBlur.bind(this),this._element.addEventListener("keydown",this._keydownHandler),this._element.addEventListener("keyup",this._keyupHandler),window.addEventListener("blur",this._blurHandler),this._dynamics=new i,this._pressing=!1}r(s),s.prototype.destroy=function(){this._element.removeEventListener("keydown",this._keydownHandler),this._element.removeEventListener("keyup",this._keyupHandler),window.removeEventListener("blur",this._blurHandler),o(this)},s.prototype._handlePress=function(t){t.keyCode===this._keyCode&&(this._pressing=!0,this._dynamics.velocity=this._velocity,this._dynamics.friction=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("active"))},s.prototype._handleRelease=function(t){t.keyCode===this._keyCode&&(this._pressing&&(this._dynamics.friction=this._friction,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive")),this._pressing=!1)},s.prototype._handleBlur=function(){this._dynamics.velocity=0,this.emit("parameterDynamics",this._parameter,this._dynamics),this.emit("inactive"),this._pressing=!1},t.exports=s},425:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(6112);function a(t,e,n){this._hammer=o.get(t,e),this._lastEvent=null,this._active=!1,this._dynamics=new i,this._hammer.on("pinchstart",this._handleStart.bind(this)),this._hammer.on("pinch",this._handleEvent.bind(this)),this._hammer.on("pinchend",this._handleEnd.bind(this)),this._hammer.on("pinchcancel",this._handleEnd.bind(this))}r(a),a.prototype.destroy=function(){this._hammer.release(),s(this)},a.prototype._handleStart=function(){this._active||(this._active=!0,this.emit("active"))},a.prototype._handleEnd=function(){this._lastEvent=null,this._active&&(this._active=!1,this.emit("inactive"))},a.prototype._handleEvent=function(t){var e=t.scale;this._lastEvent&&(e/=this._lastEvent.scale),this._dynamics.offset=-((e-1)*1),this.emit("parameterDynamics","zoom",this._dynamics),this._lastEvent=t},t.exports=a},9203:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(8975),s=n(9821),a=n(958).maxFriction,h=n(6112),u={speed:8,friction:6,maxFrictionTime:.3};function c(t,e,n){this._element=t,this._opts=s(n||{},u),this._active=!1,this._hammer=o.get(t,e),this._dynamics={x:new i,y:new i},this._hammer.on("panstart",this._handleStart.bind(this)),this._hammer.on("panmove",this._handleMove.bind(this)),this._hammer.on("panend",this._handleRelease.bind(this)),this._hammer.on("pancancel",this._handleRelease.bind(this))}r(c),c.prototype.destroy=function(){this._hammer.release(),h(this)},c.prototype._handleStart=function(t){t.preventDefault(),this._active||(this._active=!0,this.emit("active"))},c.prototype._handleMove=function(t){t.preventDefault(),this._updateDynamics(t,!1)},c.prototype._handleRelease=function(t){t.preventDefault(),this._updateDynamics(t,!0),this._active&&(this._active=!1,this.emit("inactive"))};var l=[null,null];c.prototype._updateDynamics=function(t,e){var n=this._element.getBoundingClientRect(),r=Math.max(n.right-n.left,n.bottom-n.top),i=t.deltaX/r*this._opts.speed,o=t.deltaY/r*this._opts.speed;this._dynamics.x.reset(),this._dynamics.y.reset(),this._dynamics.x.velocity=i,this._dynamics.y.velocity=o,e&&(a(this._opts.friction,this._dynamics.x.velocity,this._dynamics.y.velocity,this._opts.maxFrictionTime,l),this._dynamics.x.friction=l[0],this._dynamics.y.friction=l[1]),this.emit("parameterDynamics","x",this._dynamics.x),this.emit("parameterDynamics","y",this._dynamics.y)},t.exports=c},9166:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(9821),s=n(6112),a={frictionTime:.2,zoomDelta:.001};function h(t,e){this._element=t,this._opts=o(e||{},a),this._dynamics=new i,this._eventList=[];var n=this._opts.frictionTime?this.withSmoothing:this.withoutSmoothing;this._wheelListener=n.bind(this),t.addEventListener("wheel",this._wheelListener)}function u(t){var e=1==t.deltaMode?20:1;return t.deltaY*e}r(h),h.prototype.destroy=function(){this._element.removeEventListener("wheel",this._wheelListener),s(this)},h.prototype.withoutSmoothing=function(t){this._dynamics.offset=u(t)*this._opts.zoomDelta,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},h.prototype.withSmoothing=function(t){var e=t.timeStamp;for(this._eventList.push(t);this._eventList[0].timeStamp<e-1e3*this._opts.frictionTime;)this._eventList.shift(0);for(var n=0,r=0;r<this._eventList.length;r++)n+=u(this._eventList[r])*this._opts.zoomDelta/this._opts.frictionTime;this._dynamics.velocity=n,this._dynamics.friction=Math.abs(n)/this._opts.frictionTime,this.emit("parameterDynamics","zoom",this._dynamics),t.preventDefault(),this.emit("active"),this.emit("inactive")},t.exports=h},8255:function(t,e,n){"use strict";var r=n(5696),i=n(4301),o=n(6112);function s(t){if(!t)throw Error("VelocityControlMethod: parameter must be defined");this._parameter=t,this._dynamics=new i}r(s),s.prototype.destroy=function(){o(this)},s.prototype.setVelocity=function(t){this._dynamics.velocity=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},s.prototype.setFriction=function(t){this._dynamics.friction=t,this.emit("parameterDynamics",this._parameter,this._dynamics)},t.exports=s},7895:function(t,e,n){"use strict";var r=n(9821),i=n(9869),o=n(9203),s=n(9166),a=n(425),h=n(3939),u={mouseViewMode:"drag",dragMode:"pan"};t.exports=function(t,e,n){n=r(n||{},u);var c={mouseViewDrag:new i(e,"mouse"),mouseViewQtvr:new o(e,"mouse"),leftArrowKey:new h(37,"x",-.7,3),rightArrowKey:new h(39,"x",.7,3),upArrowKey:new h(38,"y",-.7,3),downArrowKey:new h(40,"y",.7,3),plusKey:new h(107,"zoom",-.7,3),minusKey:new h(109,"zoom",.7,3),wKey:new h(87,"y",-.7,3),aKey:new h(65,"x",-.7,3),sKey:new h(83,"y",.7,3),dKey:new h(68,"x",.7,3),qKey:new h(81,"roll",.7,3),eKey:new h(69,"roll",-.7,3)},l=["scrollZoom","touchView","pinch"];!1!==n.scrollZoom&&(c.scrollZoom=new s(e));var f={arrowKeys:["leftArrowKey","rightArrowKey","upArrowKey","downArrowKey"],plusMinusKeys:["plusKey","minusKey"],wasdKeys:["wKey","aKey","sKey","dKey"],qeKeys:["qKey","eKey"]};switch(n.dragMode){case"pinch":c.pinch=new i(e,"touch",{hammerEvent:"pinch"});break;case"pan":c.touchView=new i(e,"touch"),c.pinch=new a(e,"touch");break;default:throw Error("Unknown drag mode: "+n.dragMode)}switch(n.mouseViewMode){case"drag":l.push("mouseViewDrag");break;case"qtvr":l.push("mouseViewQtvr");break;default:throw Error("Unknown mouse view mode: "+n.mouseViewMode)}for(var p in c){var d=c[p];t.registerMethod(p,d),l.indexOf(p)>=0&&t.enableMethod(p)}for(var v in f){var m=f[v];t.addMethodGroup(v,m)}return c}},958:function(t){"use strict";function e(t,e,n,r){var i=Math.atan(e/t);r[0]=n*Math.cos(i),r[1]=n*Math.sin(i)}t.exports={maxFriction:function(t,n,r,i,o){t=Math.max(t,Math.sqrt(Math.pow(n,2)+Math.pow(r,2))/i),e(n,r,t,o),o[0]=Math.abs(o[0]),o[1]=Math.abs(o[1])},changeVectorNorm:e}},9032:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(6085),s=n(46),a=n(2467),h=n(6762).makeLevelList,u=n(6762).makeSelectableLevelList,c=n(5342),l=n(7784),f=n(3969),p=n(5994).vec3,d=n(5994).vec4,v="fudlrb",m={f:{x:0,y:0},b:{x:0,y:Math.PI},l:{x:0,y:Math.PI/2},r:{x:0,y:-Math.PI/2},u:{x:Math.PI/2,y:0},d:{x:-Math.PI/2,y:0}},_=p.create();function y(t,e,n,r){e&&p.rotateZ(t,t,_,e),n&&p.rotateX(t,t,_,n),r&&p.rotateY(t,t,_,r)}for(var g={},M=0;M<v.length;M++){var w=v[M],x=m[w],b=p.fromValues(0,0,-1);y(b,0,x.x,x.y),g[w]=b}var E={f:["l","r","u","d"],b:["r","l","u","d"],l:["b","f","u","d"],r:["f","b","u","d"],u:["l","r","b","f"],d:["l","r","f","b"]},T=[[0,1],[1,0],[0,-1],[-1,0]];function L(t,e,n,r,i){this.face=t,this.x=e,this.y=n,this.z=r,this._geometry=i,this._level=i.levelList[r]}function C(t){if(this.constructor.super_.call(this,t),this._size=t.size,this._tileSize=t.tileSize,this._size%this._tileSize!=0)throw Error("Level size is not multiple of tile size: "+this._size+" "+this._tileSize)}function S(t){if("array"!==f(t))throw Error("Level list must be an array");this.levelList=h(t,C),this.selectableLevelList=u(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new o(this),this._neighborsCache=new s(64),this._vec=d.create(),this._viewSize={}}L.prototype.rotX=function(){return m[this.face].x},L.prototype.rotY=function(){return m[this.face].y},L.prototype.centerX=function(){return(this.x+.5)/this._level.numHorizontalTiles()-.5},L.prototype.centerY=function(){return .5-(this.y+.5)/this._level.numVerticalTiles()},L.prototype.scaleX=function(){return 1/this._level.numHorizontalTiles()},L.prototype.scaleY=function(){return 1/this._level.numVerticalTiles()},L.prototype.vertices=function(t){t||(t=[p.create(),p.create(),p.create(),p.create()]);var e=m[this.face];function n(t,n,r){p.set(t,n,r,-.5),y(t,0,e.x,e.y)}var r=this.centerX()-this.scaleX()/2,i=this.centerX()+this.scaleX()/2,o=this.centerY()-this.scaleY()/2,s=this.centerY()+this.scaleY()/2;return n(t[0],r,s),n(t[1],i,s),n(t[2],i,o),n(t[3],r,o),t},L.prototype.parent=function(){if(0===this.z)return null;var t=this.face,e=this.z,n=this.x,r=this.y,i=this._geometry,o=i.levelList[e],s=i.levelList[e-1],a=Math.floor(n/o.numHorizontalTiles()*s.numHorizontalTiles()),h=Math.floor(r/o.numVerticalTiles()*s.numVerticalTiles());return new L(t,a,h,e-1,i)},L.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this.face,n=this.z,r=this.x,i=this.y,o=this._geometry,s=o.levelList[n],a=o.levelList[n+1],h=a.numHorizontalTiles()/s.numHorizontalTiles(),u=a.numVerticalTiles()/s.numVerticalTiles();t=t||[];for(var c=0;c<h;c++)for(var l=0;l<u;l++){var f=h*r+c,p=u*i+l,d=n+1;t.push(new L(e,f,p,d,o))}return t},L.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var r=t._vec,i=this.face,o=this.x,s=this.y,a=this.z,h=this._level,u=h.numHorizontalTiles(),l=h.numVerticalTiles(),f=[],d=0;d<T.length;d++){var v=T[d][0],_=T[d][1],g=o+v,M=s+_,w=i;if(g<0||g>=u||M<0||M>=l){var x,b=this.centerX(),C=this.centerY();g<0?(p.set(r,-.5,C,-.5),w=E[i][0]):g>=u?(p.set(r,.5,C,-.5),w=E[i][1]):M<0?(p.set(r,b,.5,-.5),w=E[i][2]):M>=l&&(p.set(r,b,-.5,-.5),w=E[i][3]),y(r,0,(x=m[i]).x,x.y),y(r,0,-(x=m[w]).x,-x.y),g=c(Math.floor((.5+r[0])*u),0,u-1),M=c(Math.floor((.5-r[1])*l),0,l-1)}f.push(new L(w,g,M,a,t))}return e.set(this,f),f},L.prototype.hash=function(){return i(v.indexOf(this.face),this.z,this.y,this.x)},L.prototype.equals=function(t){return this._geometry===t._geometry&&this.face===t.face&&this.z===t.z&&this.y===t.y&&this.x===t.x},L.prototype.cmp=function(t){return l(this.z,t.z)||l(v.indexOf(this.face),v.indexOf(t.face))||l(this.y,t.y)||l(this.x,t.x)},L.prototype.str=function(){return"CubeTile("+tile.face+", "+tile.x+", "+tile.y+", "+tile.z+")"},r(C,a),C.prototype.width=function(){return this._size},C.prototype.height=function(){return this._size},C.prototype.tileWidth=function(){return this._tileSize},C.prototype.tileHeight=function(){return this._tileSize},C.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),r=this.tileWidth(),i=this.tileHeight(),o=this.numHorizontalTiles(),s=this.numVerticalTiles(),a=t.width(),h=t.height(),u=t.tileWidth(),c=t.tileHeight(),l=t.numHorizontalTiles(),f=t.numVerticalTiles();if(e%a!=0)throw Error("Level width must be multiple of parent level: "+e+" vs. "+a);if(n%h!=0)throw Error("Level height must be multiple of parent level: "+n+" vs. "+h);if(o%l!=0)throw Error("Number of horizontal tiles must be multiple of parent level: "+o+" ("+e+"/"+r+") vs. "+l+" ("+a+"/"+u+")");if(s%f!=0)throw Error("Number of vertical tiles must be multiple of parent level: "+s+" ("+n+"/"+i+") vs. "+f+" ("+h+"/"+c+")")},S.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},S.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,i=t.numVerticalTiles()-1;e=e||[];for(var o=0;o<v.length;o++)for(var s=v[o],a=0;a<=r;a++)for(var h=0;h<=i;h++)e.push(new L(s,a,h,n,this));return e},S.prototype._closestTile=function(t,e){var n=this._vec;d.set(n,0,0,1,1),d.transformMat4(n,n,t.inverseProjection());var r=1/0,i=null;for(var o in g){var s=g[o],a=1-p.dot(s,n);a<r&&(r=a,i=o)}for(var h=Math.max(Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2]))/.5,u=0;u<3;u++)n[u]=n[u]/h;var l=m[i];y(n,0,-l.x,-l.y);var f=this.levelList.indexOf(e),v=e.numHorizontalTiles(),_=e.numVerticalTiles(),M=c(Math.floor((.5+n[0])*v),0,v-1),w=c(Math.floor((.5-n[1])*_),0,_-1);return new L(i,M,w,f,this)},S.prototype.visibleTiles=function(t,e,n){var r=this._viewSize,i=this._tileSearcher;if(n=n||[],t.size(r),0===r.width||0===r.height)return n;var o=this._closestTile(t,e);if(!i.search(t,o,n))throw Error("Starting tile is not visible");return n},S.Tile=S.prototype.Tile=L,S.type=S.prototype.type="cube",L.type=L.prototype.type="cube",t.exports=S},8988:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(7784),s=n(6762),a=n(2467),h=n(3969);function u(t,e){this.z=t,this._geometry=e,this._level=e.levelList[t]}function c(t){this.constructor.super_.call(this,t),this._width=t.width}function l(t){if("array"!==h(t))throw Error("Level list must be an array");this.levelList=s.makeLevelList(t,c),this.selectableLevelList=s.makeSelectableLevelList(this.levelList)}u.prototype.rotX=function(){return 0},u.prototype.rotY=function(){return 0},u.prototype.centerX=function(){return .5},u.prototype.centerY=function(){return .5},u.prototype.scaleX=function(){return 1},u.prototype.scaleY=function(){return 1},u.prototype.parent=function(){return 0===this.z?null:new u(this.z-1,this._geometry)},u.prototype.children=function(t){return this.z===this._geometry.levelList.length-1?null:((t=t||[]).push(new u(this.z+1,this._geometry)),t)},u.prototype.neighbors=function(){return[]},u.prototype.hash=function(){return i(this.z)},u.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z},u.prototype.cmp=function(t){return o(this.z,t.z)},u.prototype.str=function(){return"EquirectTile("+tile.z+")"},r(c,a),c.prototype.width=function(){return this._width},c.prototype.height=function(){return this._width/2},c.prototype.tileWidth=function(){return this._width},c.prototype.tileHeight=function(){return this._width/2},l.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},l.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t);return(e=e||[]).push(new u(n,this)),e},l.prototype.visibleTiles=function(t,e,n){var r=new u(this.levelList.indexOf(e),this);(n=n||[]).length=0,n.push(r)},l.Tile=l.prototype.Tile=u,l.type=l.prototype.type="equirect",u.type=u.prototype.type="equirect",t.exports=l},754:function(t,e,n){"use strict";var r=n(5003),i=n(6056),o=n(6085),s=n(46),a=n(2467),h=n(6762).makeLevelList,u=n(6762).makeSelectableLevelList,c=n(5342),l=n(8001),f=n(7784),p=n(3969),d=n(5994).vec2,v=n(5994).vec4,m=[[0,1],[1,0],[0,-1],[-1,0]];function _(t,e,n,r){this.x=t,this.y=e,this.z=n,this._geometry=r,this._level=r.levelList[n]}function y(t){this.constructor.super_.call(this,t),this._width=t.width,this._height=t.height,this._tileWidth=t.tileWidth,this._tileHeight=t.tileHeight}function g(t){if("array"!==p(t))throw Error("Level list must be an array");this.levelList=h(t,y),this.selectableLevelList=u(this.levelList);for(var e=1;e<this.levelList.length;e++)this.levelList[e]._validateWithParentLevel(this.levelList[e-1]);this._tileSearcher=new o(this),this._neighborsCache=new s(64),this._vec=v.create(),this._viewSize={}}_.prototype.rotX=function(){return 0},_.prototype.rotY=function(){return 0},_.prototype.centerX=function(){var t=this._level.width(),e=this._level.tileWidth();return(this.x*e+.5*this.width())/t-.5},_.prototype.centerY=function(){var t=this._level.height(),e=this._level.tileHeight();return .5-(this.y*e+.5*this.height())/t},_.prototype.scaleX=function(){var t=this._level.width();return this.width()/t},_.prototype.scaleY=function(){var t=this._level.height();return this.height()/t},_.prototype.width=function(){var t=this._level.width(),e=this._level.tileWidth();return this.x===this._level.numHorizontalTiles()-1&&l(t,e)||e},_.prototype.height=function(){var t=this._level.height(),e=this._level.tileHeight();return this.y===this._level.numVerticalTiles()-1&&l(t,e)||e},_.prototype.levelWidth=function(){return this._level.width()},_.prototype.levelHeight=function(){return this._level.height()},_.prototype.vertices=function(t){t||(t=[d.create(),d.create(),d.create(),d.create()]);var e=this.centerX()-this.scaleX()/2,n=this.centerX()+this.scaleX()/2,r=this.centerY()-this.scaleY()/2,i=this.centerY()+this.scaleY()/2;return d.set(t[0],e,i),d.set(t[1],n,i),d.set(t[2],n,r),d.set(t[3],e,r),t},_.prototype.parent=function(){if(0===this.z)return null;var t=this._geometry,e=this.z-1,n=Math.floor(this.x/2),r=Math.floor(this.y/2);return new _(n,r,e,t)},_.prototype.children=function(t){if(this.z===this._geometry.levelList.length-1)return null;var e=this._geometry,n=this.z+1;return(t=t||[]).push(new _(2*this.x,2*this.y,n,e)),t.push(new _(2*this.x,2*this.y+1,n,e)),t.push(new _(2*this.x+1,2*this.y,n,e)),t.push(new _(2*this.x+1,2*this.y+1,n,e)),t},_.prototype.neighbors=function(){var t=this._geometry,e=t._neighborsCache,n=e.get(this);if(n)return n;for(var r=this.x,i=this.y,o=this.z,s=this._level,a=s.numHorizontalTiles()-1,h=s.numVerticalTiles()-1,u=[],c=0;c<m.length;c++){var l=m[c][0],f=m[c][1],p=r+l,d=i+f;0<=p&&p<=a&&0<=d&&d<=h&&u.push(new _(p,d,o,t))}return e.set(this,u),u},_.prototype.hash=function(){return i(this.z,this.y,this.x)},_.prototype.equals=function(t){return this._geometry===t._geometry&&this.z===t.z&&this.y===t.y&&this.x===t.x},_.prototype.cmp=function(t){return f(this.z,t.z)||f(this.y,t.y)||f(this.x,t.x)},_.prototype.str=function(){return"FlatTile("+tile.x+", "+tile.y+", "+tile.z+")"},r(y,a),y.prototype.width=function(){return this._width},y.prototype.height=function(){return this._height},y.prototype.tileWidth=function(){return this._tileWidth},y.prototype.tileHeight=function(){return this._tileHeight},y.prototype._validateWithParentLevel=function(t){var e=this.width(),n=this.height(),r=this.tileWidth(),i=this.tileHeight(),o=t.width(),s=t.height(),a=t.tileWidth(),h=t.tileHeight();return e%o!=0?Error("Level width must be multiple of parent level: "+e+" vs. "+o):n%s!=0?Error("Level height must be multiple of parent level: "+n+" vs. "+s):r%a!=0?Error("Level tile width must be multiple of parent level: "+r+" vs. "+a):i%h!=0?Error("Level tile height must be multiple of parent level: "+i+" vs. "+h):void 0},g.prototype.maxTileSize=function(){for(var t=0,e=0;e<this.levelList.length;e++){var n=this.levelList[e];t=Math.max(t,n.tileWidth,n.tileHeight)}return t},g.prototype.levelTiles=function(t,e){var n=this.levelList.indexOf(t),r=t.numHorizontalTiles()-1,i=t.numVerticalTiles()-1;e||(e=[]);for(var o=0;o<=r;o++)for(var s=0;s<=i;s++)e.push(new _(o,s,n,this));return e},g.prototype._closestTile=function(t,e){var n=this._vec;v.set(n,0,0,1,1),v.transformMat4(n,n,t.inverseProjection());var r=.5+n[0],i=.5-n[1],o=this.levelList.indexOf(e),s=e.width(),a=e.height(),h=e.tileWidth(),u=e.tileHeight(),l=e.numHorizontalTiles(),f=e.numVerticalTiles(),p=c(Math.floor(r*s/h),0,l-1),d=c(Math.floor(i*a/u),0,f-1);return new _(p,d,o,this)},g.prototype.visibleTiles=function(t,e,n){var r=this._viewSize,i=this._tileSearcher;if(n=n||[],t.size(r),0===r.width||0===r.height)return n;var o=this._closestTile(t,e);if(!i.search(t,o,n))throw Error("Starting tile is not visible");return n},g.Tile=g.prototype.Tile=_,g.type=g.prototype.type="flat",_.type=_.prototype.type="flat",t.exports=g},2467:function(t){"use strict";function e(t){this._fallbackOnly=!!t.fallbackOnly}e.prototype.numHorizontalTiles=function(){return Math.ceil(this.width()/this.tileWidth())},e.prototype.numVerticalTiles=function(){return Math.ceil(this.height()/this.tileHeight())},e.prototype.fallbackOnly=function(){return this._fallbackOnly},t.exports=e},6762:function(t,e,n){"use strict";var r=n(7784);t.exports={makeLevelList:function(t,e){for(var n=[],i=0;i<t.length;i++)n.push(new e(t[i]));return n.sort(function(t,e){return r(t.width(),e.width())}),n},makeSelectableLevelList:function(t){for(var e=[],n=0;n<t.length;n++)t[n]._fallbackOnly||e.push(t[n]);if(!e.length)throw Error("No selectable levels in list");return e}}},5982:function(t,e,n){"use strict";t.exports={WebGlStage:n(5662),WebGlCubeRenderer:n(4641),WebGlFlatRenderer:n(591),WebGlEquirectRenderer:n(9999),registerDefaultRenderers:n(1505),CubeGeometry:n(9032),FlatGeometry:n(754),EquirectGeometry:n(8988),RectilinearView:n(3070),FlatView:n(8793),ImageUrlSource:n(6105),SingleAssetSource:n(541),StaticAsset:n(3188),DynamicAsset:n(3909),TextureStore:n(7559),Layer:n(4221),RenderLoop:n(3036),KeyControlMethod:n(3939),DragControlMethod:n(9869),QtvrControlMethod:n(9203),ScrollZoomControlMethod:n(9166),PinchZoomControlMethod:n(425),VelocityControlMethod:n(8255),ElementPressControlMethod:n(6067),Controls:n(1839),Dynamics:n(4301),Viewer:n(7599),Scene:n(5214),Hotspot:n(1154),HotspotContainer:n(3561),colorEffects:n(8842),registerDefaultControls:n(7895),autorotate:n(4273),util:{async:n(8667),cancelize:n(8246),chain:n(8111),clamp:n(5342),clearOwnProperties:n(6112),cmp:n(7784),compose:n(6414),convertFov:n(1745),decimal:n(4743),defaults:n(9821),defer:n(3522),degToRad:n(6389),delay:n(9300),dom:n(6939),extend:n(8804),hash:n(6056),inherits:n(5003),mod:n(8001),noop:n(3120),now:n(1227),once:n(827),pixelRatio:n(2468),radToDeg:n(910),real:n(6467),retry:n(2582),tween:n(5026),type:n(3969)},dependencies:{bowser:n(5470),glMatrix:n(5994),eventEmitter:n(5696),hammerjs:n(840)}}},1317:function(t,e,n){"use strict";var r=n(3188),i=n(3344),o=n(5470),s=n(5135),a=n(827),h=!!s.createImageBitmap&&!o.firefox,u={imageOrientation:"flipY",premultiplyAlpha:"premultiply"};function c(t){this._stage=t}c.prototype.loadImage=function(t,e,n){var r=this,i=new Image;i.crossOrigin="anonymous";var o=e&&e.x||0,s=e&&e.y||0,h=e&&e.width||1,u=e&&e.height||1;return n=a(n),i.onload=function(){r._handleLoad(i,o,s,h,u,n)},i.onerror=function(){r._handleError(t,n)},i.src=t,function(){i.onload=i.onerror=null,i.src="",n.apply(null,arguments)}},c.prototype._handleLoad=function(t,e,n,i,o,a){if(0===e&&0===n&&1===i&&1===o){a(null,new r(t));return}if(e*=t.naturalWidth,n*=t.naturalHeight,i*=t.naturalWidth,o*=t.naturalHeight,h)s.createImageBitmap(t,e,n,i,o,u).then(function(t){a(null,new r(t))});else{var c=document.createElement("canvas");c.width=i,c.height=o,c.getContext("2d").drawImage(t,e,n,i,o,0,0,i,o),a(null,new r(c))}},c.prototype._handleError=function(t,e){e(new i("Network error: "+t))},t.exports=c},4586:function(t,e,n){"use strict";var r=n(5994).mat4,i=n(5994).vec3,o=n(6112),s=n(8074),a=s.createConstantBuffers,h=s.destroyConstantBuffers,u=s.createShaderProgram,c=s.destroyShaderProgram,l=s.enableAttributes,f=s.disableAttributes,p=s.setViewport,d=s.setupPixelEffectUniforms,v=s.setDepth,m=s.setTexture,_=n(3846),y=n(2827),g=[0,1,2,0,2,3],M=[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],w=[0,0,1,0,1,1,0,1],x=["aVertexPosition","aTextureCoord"],b=["uDepth","uOpacity","uSampler","uProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix"];function E(t){this.gl=t,this.projMatrix=r.create(),this.viewportMatrix=r.create(),this.translateVector=i.create(),this.scaleVector=i.create(),this.constantBuffers=a(t,g,M,w),this.shaderProgram=u(t,_,y,x,b)}E.prototype.destroy=function(){h(this.gl,this.constantBuffers),c(this.gl,this.shaderProgram),o(this)},E.prototype.startLayer=function(t,e){var n=this.gl,r=this.shaderProgram,i=this.constantBuffers,o=this.viewportMatrix;n.useProgram(r),l(n,r),p(n,t,e,o),n.uniformMatrix4fv(r.uViewportMatrix,!1,o),n.bindBuffer(n.ARRAY_BUFFER,i.vertexPositions),n.vertexAttribPointer(r.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,i.textureCoords),n.vertexAttribPointer(r.aTextureCoord,2,n.FLOAT,n.FALSE,0,0),d(n,t.effects(),{opacity:r.uOpacity,colorOffset:r.uColorOffset,colorMatrix:r.uColorMatrix})},E.prototype.endLayer=function(t,e){f(this.gl,this.shaderProgram)},E.prototype.renderTile=function(t,e,n,i){var o=this.gl,s=this.shaderProgram,a=this.constantBuffers,h=this.projMatrix,u=this.translateVector,c=this.scaleVector;u[0]=t.centerX(),u[1]=t.centerY(),u[2]=-.5,c[0]=t.scaleX(),c[1]=t.scaleY(),c[2]=1,r.copy(h,n.view().projection()),r.rotateX(h,h,t.rotX()),r.rotateY(h,h,t.rotY()),r.translate(h,h,u),r.scale(h,h,c),o.uniformMatrix4fv(s.uProjMatrix,!1,h),v(o,s,i,t.z),m(o,s,e),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,a.vertexIndices),o.drawElements(o.TRIANGLES,g.length,o.UNSIGNED_SHORT,0)},t.exports=E},8074:function(t,e,n){"use strict";var r=n(5342),i=n(5994).vec4,o=n(5994).vec3,s=n(5994).mat4;function a(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw t.getShaderInfoLog(r);return r}function h(t,e,n,r){var i=t.createBuffer();return t.bindBuffer(e,i),t.bufferData(e,r,n),i}var u=i.create(),c=s.create();s.identity(c);var l=o.create(),f=o.create();t.exports={createShaderProgram:function(t,e,n,r,i){var o=a(t,t.VERTEX_SHADER,e),s=a(t,t.FRAGMENT_SHADER,n),h=t.createProgram();if(t.attachShader(h,o),t.attachShader(h,s),t.linkProgram(h),!t.getProgramParameter(h,t.LINK_STATUS))throw t.getProgramInfoLog(h);for(var u=0;u<r.length;u++){var c=r[u];if(h[c]=t.getAttribLocation(h,c),-1===h[c])throw Error("Shader program has no "+c+" attribute")}for(var l=0;l<i.length;l++){var f=i[l];if(h[f]=t.getUniformLocation(h,f),-1===h[f])throw Error("Shader program has no "+f+" uniform")}return h},destroyShaderProgram:function(t,e){for(var n=t.getAttachedShaders(e),r=0;r<n.length;r++){var i=n[r];t.detachShader(e,i),t.deleteShader(i)}t.deleteProgram(e)},createConstantBuffers:function(t,e,n,r){return{vertexIndices:h(t,t.ELEMENT_ARRAY_BUFFER,t.STATIC_DRAW,new Uint16Array(e)),vertexPositions:h(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(n)),textureCoords:h(t,t.ARRAY_BUFFER,t.STATIC_DRAW,new Float32Array(r))}},destroyConstantBuffers:function(t,e){t.deleteBuffer(e.vertexIndices),t.deleteBuffer(e.vertexPositions),t.deleteBuffer(e.textureCoords)},enableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++)t.enableVertexAttribArray(r)},disableAttributes:function(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++)t.disableVertexAttribArray(r)},setTexture:function(t,e,n){t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n._texture),t.uniform1i(e.uSampler,0)},setDepth:function(t,e,n,r){t.uniform1f(e.uDepth,((n+1)*256-r)/65536)},setViewport:function(t,e,n,i){if(0===n.x&&1===n.width&&0===n.y&&1===n.height){t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),s.identity(i);return}var a=n.x,h=r(a,0,1),u=h-a,c=r(n.width-u,0,1-h),p=n.width-c,d=1-n.height-n.y,v=r(d,0,1),m=v-d,_=r(n.height-m,0,1-v),y=n.height-_;o.set(f,n.width/c,n.height/_,1),o.set(l,(p-u)/c,(y-m)/_,0),s.identity(i),s.translate(i,i,l),s.scale(i,i,f),t.viewport(t.drawingBufferWidth*h,t.drawingBufferHeight*v,t.drawingBufferWidth*c,t.drawingBufferHeight*_)},setupPixelEffectUniforms:function(t,e,n){var r=1;e&&null!=e.opacity&&(r=e.opacity),t.uniform1f(n.opacity,r);var i=u;e&&e.colorOffset&&(i=e.colorOffset),t.uniform4fv(n.colorOffset,i);var o=c;e&&e.colorMatrix&&(o=e.colorMatrix),t.uniformMatrix4fv(n.colorMatrix,!1,o)}}},4641:function(t,e,n){"use strict";var r=n(4586);function i(){this.constructor.super_.apply(this,arguments)}n(5003)(i,r),t.exports=i},9999:function(t,e,n){"use strict";var r=n(5994).mat4,i=n(6112),o=n(8074),s=o.createConstantBuffers,a=o.destroyConstantBuffers,h=o.createShaderProgram,u=o.destroyShaderProgram,c=o.enableAttributes,l=o.disableAttributes,f=o.setViewport,p=o.setupPixelEffectUniforms,d=o.setDepth,v=o.setTexture,m=n(453),_=n(8738),y=[0,1,2,0,2,3],g=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],M=[0,0,1,0,1,1,0,1],w=["aVertexPosition"],x=["uDepth","uOpacity","uSampler","uInvProjMatrix","uViewportMatrix","uColorOffset","uColorMatrix","uTextureX","uTextureY","uTextureWidth","uTextureHeight"];function b(t){this.gl=t,this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.constantBuffers=s(t,y,g,M),this.shaderProgram=h(t,m,_,w,x)}b.prototype.destroy=function(){a(this.gl,this.constantBuffers),u(this.gl,this.shaderProgram),i(this)},b.prototype.startLayer=function(t,e){var n=this.gl,i=this.shaderProgram,o=this.constantBuffers,s=this.invProjMatrix,a=this.viewportMatrix;n.useProgram(i),c(n,i),f(n,t,e,a),n.uniformMatrix4fv(i.uViewportMatrix,!1,a),n.bindBuffer(n.ARRAY_BUFFER,o.vertexPositions),n.vertexAttribPointer(i.aVertexPosition,3,n.FLOAT,n.FALSE,0,0),n.bindBuffer(n.ARRAY_BUFFER,o.textureCoords),r.copy(s,t.view().projection()),r.invert(s,s),n.uniformMatrix4fv(i.uInvProjMatrix,!1,s);var h=t.effects().textureCrop||{},u=null!=h.x?h.x:0,l=null!=h.y?h.y:0,d=null!=h.width?h.width:1,v=null!=h.height?h.height:1;n.uniform1f(i.uTextureX,u),n.uniform1f(i.uTextureY,l),n.uniform1f(i.uTextureWidth,d),n.uniform1f(i.uTextureHeight,v),p(n,t.effects(),{opacity:i.uOpacity,colorOffset:i.uColorOffset,colorMatrix:i.uColorMatrix})},b.prototype.endLayer=function(t,e){l(this.gl,this.shaderProgram)},b.prototype.renderTile=function(t,e,n,r){var i=this.gl,o=this.shaderProgram,s=this.constantBuffers;d(i,o,r,t.z),v(i,o,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,s.vertexIndices),i.drawElements(i.TRIANGLES,y.length,i.UNSIGNED_SHORT,0)},t.exports=b},591:function(t,e,n){"use strict";var r=n(4586);function i(){this.constructor.super_.apply(this,arguments)}n(5003)(i,r),t.exports=i},1505:function(t,e,n){"use strict";var r=n(4641),i=n(591),o=n(9999);t.exports=function(t){if("webgl"===t.type)t.registerRenderer("flat","flat",i),t.registerRenderer("cube","rectilinear",r),t.registerRenderer("equirect","rectilinear",o);else throw Error("Unknown stage type: "+t.type)}},8738:function(t){"use strict";t.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float\n#endif\nuniform sampler2D uSampler;\nuniform float uOpacity;\nuniform float uTextureX;\nuniform float uTextureY;\nuniform float uTextureWidth;\nuniform float uTextureHeight;\nuniform vec4 uColorOffset;\nuniform mat4 uColorMatrix;\nvarying vec4 vRay;\nconst float PI = 3.14159265358979323846264;\nvoid main(void) {\n  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);\n  float phi  = acos(vRay.y * r);\n  float theta = atan(vRay.x, -1.0*vRay.z);\n  float s = 0.5 + 0.5 * theta / PI;\n  float t = 1.0 - phi / PI;\n  s = s * uTextureWidth + uTextureX;\n  t = t * uTextureHeight + uTextureY;\n  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;\n  gl_FragColor = vec4(color.rgba * uOpacity);\n}"},2827:function(t){"use strict";t.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D uSampler;\nuniform float uOpacity;\nuniform vec4 uColorOffset;\nuniform mat4 uColorMatrix;\nvarying vec2 vTextureCoord;\nvoid main(void) {\n  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;\n  gl_FragColor = vec4(color.rgba * uOpacity);\n}"},453:function(t){"use strict";t.exports="attribute vec3 aVertexPosition;\nuniform float uDepth;\nuniform mat4 uViewportMatrix;\nuniform mat4 uInvProjMatrix;\nvarying vec4 vRay;\nvoid main(void) {\n  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);\n  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);\n}"},3846:function(t){"use strict";t.exports="attribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform float uDepth;\nuniform mat4 uViewportMatrix;\nuniform mat4 uProjMatrix;\nvarying vec2 vTextureCoord;\nvoid main(void) {\n  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\n  gl_Position.z = uDepth * gl_Position.w;\n  vTextureCoord = aTextureCoord;\n}"},6105:function(t,e,n){"use strict";var r=n(5696),i=n(3344),o=n(2604),s=n(8111),a=n(9300),h=n(1227),u={x:"x",y:"y",z:"z",f:"face"};function c(t,e){e=e||{},this._loadPool=new o({concurrency:e.concurrency||4}),this._retryDelay=e.retryDelay||1e4,this._retryMap={},this._sourceFromTile=t}r(c),c.prototype.loadAsset=function(t,e,n){var r,o=this,u=this._retryDelay,c=this._retryMap,l=this._sourceFromTile(e),f=l.url,p=l.rect,d=t.loadImage.bind(t,f,p),v=c[f];if(null!=v){var m=h()-v;m<u?r=u-m:(r=0,delete c[f])}return s(a.bind(null,r),function(t){return o._loadPool.push(d,function(n,r){n?(n instanceof i&&(c[f]=h(),o.emit("networkError",n,e)),t(n,e)):(delete c[f],t(null,e,r))})})(n)},c.fromString=function(t,e){var n=(e=e||{}).cubeMapPreviewFaceOrder||"bdflru",r=e.cubeMapPreviewUrl?function(t){var r;return 0===t.z?(r=n.indexOf(t.face)/6,{url:e.cubeMapPreviewUrl,rect:{x:0,y:r,width:1,height:1/6}}):i(t)}:i;return new c(r,e);function i(e){var n=t;for(var r in u){var i=u[r],o=RegExp("\\{("+r+")\\}","g"),s=e.hasOwnProperty(i)?e[i]:"";n=n.replace(o,s)}return{url:n}}},t.exports=c},541:function(t){"use strict";function e(t){this._asset=t}e.prototype.asset=function(){return this._asset},e.prototype.loadAsset=function(t,e,n){var r=this,i=setTimeout(function(){n(null,e,r._asset)},0);return function(){clearTimeout(i),n.apply(null,arguments)}},t.exports=e},6611:function(t){"use strict";function e(){this._renderers={}}e.prototype.set=function(t,e,n){this._renderers[t]||(this._renderers[t]={}),this._renderers[t][e]=n},e.prototype.get=function(t,e){return this._renderers[t]&&this._renderers[t][e]||null},t.exports=e},244:function(t,e,n){"use strict";var r=n(5696),i=n(8585),o=n(6929),s=n(8667),a=n(8246),h=n(6112),u=n(6611);function c(t,e){return t.cmp(e)}function l(t,e){return-t.cmp(e)}function f(t){this._progressive=!!(t&&t.progressive),this._layers=[],this._renderers=[],this._tilesToLoad=[],this._tilesToRender=[],this._tmpVisible=[],this._tmpChildren=[],this._width=0,this._height=0,this._tmpRect={},this._tmpSize={},this._createTextureWorkQueue=new i,this._emitRenderInvalid=this._emitRenderInvalid.bind(this),this._rendererRegistry=new u}r(f),f.prototype.destroy=function(){this.removeAllLayers(),h(this)},f.prototype.registerRenderer=function(t,e,n){return this._rendererRegistry.set(t,e,n)},f.prototype.domElement=function(){throw Error("Stage implementation must override domElement")},f.prototype.width=function(){return this._width},f.prototype.height=function(){return this._height},f.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},f.prototype.setSize=function(t){this._width=t.width,this._height=t.height,this.setSizeForType(),this.emit("resize"),this._emitRenderInvalid()},f.prototype.setSizeForType=function(t){throw Error("Stage implementation must override setSizeForType")},f.prototype.loadImage=function(){throw Error("Stage implementation must override loadImage")},f.prototype._emitRenderInvalid=function(){this.emit("renderInvalid")},f.prototype.validateLayer=function(t){throw Error("Stage implementation must override validateLayer")},f.prototype.listLayers=function(){return[].concat(this._layers)},f.prototype.hasLayer=function(t){return this._layers.indexOf(t)>=0},f.prototype.addLayer=function(t,e){if(this._layers.indexOf(t)>=0)throw Error("Layer already in stage");if(null==e&&(e=this._layers.length),e<0||e>this._layers.length)throw Error("Invalid layer position");this.validateLayer(t);var n=t.geometry().type,r=t.view().type,i=this._rendererRegistry.get(n,r);if(!i)throw Error("No "+this.type+" renderer avaiable for "+n+" geometry and "+r+" view");var o=this.createRenderer(i);this._layers.splice(e,0,t),this._renderers.splice(e,0,o),t.addEventListener("viewChange",this._emitRenderInvalid),t.addEventListener("effectsChange",this._emitRenderInvalid),t.addEventListener("fixedLevelChange",this._emitRenderInvalid),t.addEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},f.prototype.moveLayer=function(t,e){var n=this._layers.indexOf(t);if(n<0)throw Error("No such layer in stage");if(e<0||e>=this._layers.length)throw Error("Invalid layer position");t=this._layers.splice(n,1)[0];var r=this._renderers.splice(n,1)[0];this._layers.splice(e,0,t),this._renderers.splice(e,0,r),this._emitRenderInvalid()},f.prototype.removeLayer=function(t){var e=this._layers.indexOf(t);if(e<0)throw Error("No such layer in stage");var n=this._layers.splice(e,1)[0],r=this._renderers.splice(e,1)[0];this.destroyRenderer(r),n.removeEventListener("viewChange",this._emitRenderInvalid),n.removeEventListener("effectsChange",this._emitRenderInvalid),n.removeEventListener("fixedLevelChange",this._emitRenderInvalid),n.removeEventListener("textureStoreChange",this._emitRenderInvalid),this._emitRenderInvalid()},f.prototype.removeAllLayers=function(){for(;this._layers.length>0;)this.removeLayer(this._layers[0])},f.prototype.startFrame=function(){throw Error("Stage implementation must override startFrame")},f.prototype.endFrame=function(){throw Error("Stage implementation must override endFrame")},f.prototype.render=function(){var t=this._tilesToLoad,e=this._tilesToRender,n=!0,r=this._width,i=this._height,s=this._tmpRect,a=this._tmpSize;if(!(r<=0)&&!(i<=0)){for(this.startFrame(),h=0;h<this._layers.length;h++)this._layers[h].textureStore().startFrame();for(h=0;h<this._layers.length;h++){var h,u,c,l,f,p=this._layers[h],d=p.effects(),v=p.view(),m=p.textureStore(),_=this._renderers[h],y=this._layers.length-h;if(o(r,i,d&&d.rect,s),!(s.width<=0)&&!(s.height<=0)){for(a.width=s.width*this._width,a.height=s.height*this._height,v.setSize(a),_.startLayer(p,s),c=this._collectTiles(p,m),u=0;u<t.length;u++)l=t[u],m.markTile(l);for(u=0;u<e.length;u++)l=e[u],f=m.texture(l),_.renderTile(l,f,p,y);p.emit("renderComplete",c),c||(n=!1),_.endLayer(p,s)}}for(h=0;h<this._layers.length;h++)this._layers[h].textureStore().endFrame();this.endFrame(),this.emit("renderComplete",n)}},f.prototype._collectTiles=function(t,e){var n=this._tilesToLoad,r=this._tilesToRender,i=this._tmpVisible;n.length=0,r.length=0,i.length=0,t.visibleTiles(i);for(var o=!0,s=0;s<i.length;s++){var a,h=i[s];this._collectTileToLoad(h),e.texture(h)?(a=!1,this._collectTileToRender(h)):(a=this._collectChildren(h,e),o=!1),this._collectParents(h,e,a)}return n.sort(c),r.sort(l),o},f.prototype._collectChildren=function(t,e){var n=this._tmpChildren,r=!0;do{if(n.length=0,!t.children(n))break;r=!1;for(var i=0;i<n.length;i++)t=n[i],e.texture(t)?(this._collectTileToLoad(t),this._collectTileToRender(t)):r=!0}while(r&&1===n.length);return r},f.prototype._collectParents=function(t,e,n){for(var r=this._progressive;(r||n)&&null!=(t=t.parent());){if(n){if(e.texture(t))this._collectTileToRender(t),n=!1;else if(!this._progressive)continue}this._collectTileToLoad(t)||(r=!1)}return n},f.prototype._collectTileToLoad=function(t){return this._collectTileIntoList(t,this._tilesToLoad)},f.prototype._collectTileToRender=function(t){return this._collectTileIntoList(t,this._tilesToRender)},f.prototype._collectTileIntoList=function(t,e){for(var n=!1,r=0;r<e.length;r++)if(t.equals(e[r])){n=!0;break}return n||e.push(t),!n},f.prototype.createTexture=function(t,e,n){var r=this,i=a(s(function(){return new r.TextureClass(r,t,e)}));return this._createTextureWorkQueue.push(i,function(r,i){n(r,t,e,i)})},t.exports=f},5662:function(t,e,n){"use strict";var r=n(244),i=n(1317),o=n(5470),s=n(5003),a=n(2468),h=n(2533),u=n(6939).setAbsolute,c=n(6939).setFullSize,l=n(6112),f={videoUseTexImage2D:o.chrome};function p(t){t=t||{};var e=this;this.constructor.super_.call(this,t),this._generateMipmaps=null!=t.generateMipmaps&&t.generateMipmaps,this._loader=new i(this),this._domElement=document.createElement("canvas"),u(this._domElement),c(this._domElement),this._gl=function(t,e){var n={alpha:!0,premultipliedAlpha:!0,antialias:!!(e&&e.antialias),preserveDrawingBuffer:!!(e&&e.preserveDrawingBuffer)},r=t.getContext&&(t.getContext("webgl",n)||t.getContext("experimental-webgl",n));if(!r)throw Error("Could not get WebGL context");return e.wrapContext&&(r=e.wrapContext(r)),r}(this._domElement,t),this._handleContextLoss=function(){e.emit("webglcontextlost"),e._gl=null},this._domElement.addEventListener("webglcontextlost",this._handleContextLoss),this._rendererInstances=[]}function d(t,e,n){this._stage=t,this._gl=t._gl,this._texture=null,this._timestamp=null,this._width=this._height=null,this.refresh(e,n)}s(p,r),p.prototype.destroy=function(){this._domElement.removeEventListener("webglcontextlost",this._handleContextLoss),this.constructor.super_.prototype.destroy.call(this)},p.prototype.domElement=function(){return this._domElement},p.prototype.webGlContext=function(){return this._gl},p.prototype.setSizeForType=function(){var t=a();this._domElement.width=t*this._width,this._domElement.height=t*this._height},p.prototype.loadImage=function(t,e,n){return this._loader.loadImage(t,e,n)},p.prototype.maxTextureSize=function(){return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE)},p.prototype.validateLayer=function(t){var e=t.geometry().maxTileSize(),n=this.maxTextureSize();if(e>n)throw Error("Layer has level with tile size larger than maximum texture size ("+e+" vs. "+n+")")},p.prototype.createRenderer=function(t){for(var e=this._rendererInstances,n=0;n<e.length;n++)if(e[n]instanceof t)return e[n];var r=new t(this._gl);return e.push(r),r},p.prototype.destroyRenderer=function(t){var e=this._rendererInstances;if(0>this._renderers.indexOf(t)){t.destroy();var n=e.indexOf(t);n>=0&&e.splice(n,1)}},p.prototype.startFrame=function(){var t=this._gl;if(!t)throw Error("Bad WebGL context - maybe context was lost?");t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},p.prototype.endFrame=function(){},p.prototype.takeSnapshot=function(t){("object"!=typeof t||null==t)&&(t={});var e=t.quality;if(void 0===e&&(e=75),"number"!=typeof e||e<0||e>100)throw Error("WebGLStage: Snapshot quality needs to be a number between 0 and 100");return this.render(),this._domElement.toDataURL("image/jpeg",e/100)},p.type=p.prototype.type="webgl",d.prototype.refresh=function(t,e){var n,r=this._gl,i=this._stage,o=e.timestamp();if(o!==this._timestamp){var s=e.element(),a=e.width(),u=e.height();if(a!==this._width||u!==this._height){var c=i.maxTextureSize();if(a>c)throw Error("Texture width larger than max size ("+a+" vs. "+c+")");if(u>c)throw Error("Texture height larger than max size ("+u+" vs. "+c+")");this._texture&&r.deleteTexture(n),n=this._texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s)}else n=this._texture,r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s instanceof HTMLVideoElement&&f.videoUseTexImage2D?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s):r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,s);i._generateMipmaps&&h(a)&&h(u)?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR),r.generateMipmap(r.TEXTURE_2D)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null),this._timestamp=o,this._width=a,this._height=u}},d.prototype.destroy=function(){this._texture&&this._gl.deleteTexture(this._texture),l(this)},p.TextureClass=p.prototype.TextureClass=d,t.exports=p},8667:function(t){"use strict";t.exports=function(t){return function(e){var n,r;try{r=t()}catch(i){n=i}finally{n?e(n):e(null,r)}}}},6929:function(t){"use strict";t.exports=function(t,e,n,r){var i,o,s,a;return r=r||{},i=null!=n&&null!=n.absoluteWidth?n.absoluteWidth/t:null!=n&&null!=n.relativeWidth?n.relativeWidth:1,o=n&&null!=n.absoluteHeight?n.absoluteHeight/e:null!=n&&null!=n.relativeHeight?n.relativeHeight:1,s=null!=n&&null!=n.absoluteX?n.absoluteX/t:null!=n&&null!=n.relativeX?n.relativeX:0,a=null!=n&&null!=n.absoluteY?n.absoluteY/e:null!=n&&null!=n.relativeY?n.relativeY:0,r.x=s,r.y=a,r.width=i,r.height=o,r}},8246:function(t,e,n){"use strict";var r=n(827);t.exports=function(t){return function(){if(!arguments.length)throw Error("cancelized: expected at least one argument");var e=Array.prototype.slice.call(arguments,0),n=e[e.length-1]=r(e[e.length-1]);return t.apply(null,e),function(){n.apply(null,arguments)}}}},8111:function(t,e,n){"use strict";var r=n(3120);t.exports=function(){var t=Array.prototype.slice.call(arguments,0);return function(){var e=t.slice(0),n=null,i=null,o=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],s=arguments.length?arguments[arguments.length-1]:r;return o.unshift(null),(function t(){var r=arguments[0];if(r||!e.length){n=i=null,s.apply(null,arguments);return}var o=n=e.shift(),a=Array.prototype.slice.call(arguments,1);a.push(t);var h=n.apply(null,a);if(o===n){if("function"!=typeof h)throw Error("chain: chaining on non-cancellable function");i=h}}).apply(null,o),function(){i&&i.apply(null,arguments)}}}},5342:function(t){"use strict";t.exports=function(t,e,n){return Math.min(Math.max(t,e),n)}},6112:function(t){"use strict";t.exports=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]=void 0)}},7784:function(t){"use strict";t.exports=function(t,e){return t<e?-1:t>e?1:0}},6414:function(t){"use strict";t.exports=function(){var t=arguments;return function(e){for(var n=e,r=0;r<t.length;r++)n=t[r].call(null,n);return n}}},1745:function(t){"use strict";function e(t,e,n){return 2*Math.atan(n*Math.tan(t/2)/e)}t.exports={convert:e,htov:function(t,n,r){return e(t,n,r)},htod:function(t,n,r){return e(t,n,Math.sqrt(n*n+r*r))},vtoh:function(t,n,r){return e(t,r,n)},vtod:function(t,n,r){return e(t,r,Math.sqrt(n*n+r*r))},dtoh:function(t,n,r){return e(t,Math.sqrt(n*n+r*r),n)},dtov:function(t,n,r){return e(t,Math.sqrt(n*n+r*r),r)}}},4743:function(t){"use strict";t.exports=function(t){return t.toPrecision(15)}},9821:function(t){"use strict";t.exports=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t}},3522:function(t){"use strict";t.exports=function(t,e){setTimeout(function(){e&&e.length>0?t.apply(null,e):t()},0)}},6389:function(t){"use strict";t.exports=function(t){return t*Math.PI/180}},9300:function(t){"use strict";t.exports=function(t,e){var n=null;return n=setTimeout(function(){null!=n&&(n=null,e(null))},t),function(){null!=n&&(clearTimeout(n),n=null,e.apply(null,arguments))}}},6939:function(t){"use strict";function e(t){for(var e=document.documentElement.style,n=["Moz","Webkit","Khtml","O","ms"],r=0;r<n.length;r++){var i=n[r]+(t[0].toUpperCase()+t.slice(1));if(i in e)return i}return t}function n(t){var n=e(t);return function(t,e){return t.style[n]=e}}var r=n("transform"),i=n("transformOrigin");t.exports={prefixProperty:e,getWithVendorPrefix:function(t){var n=e(t);return function(t){return t.style[n]}},setWithVendorPrefix:n,setTransform:r,setTransformOrigin:i,setNullTransform:function(t){r(t,"translateZ(0)")},setNullTransformOrigin:function(t){i(t,"0 0 0")},setAbsolute:function(t){t.style.position="absolute"},setPixelPosition:function(t,e,n){t.style.left=e+"px",t.style.top=n+"px"},setPixelSize:function(t,e,n){t.style.width=e+"px",t.style.height=n+"px"},setNullSize:function(t){t.style.width=t.style.height=0},setFullSize:function(t){t.style.width=t.style.height="100%"},setOverflowHidden:function(t){t.style.overflow="hidden"},setOverflowVisible:function(t){t.style.overflow="visible"},setNoPointerEvents:function(t){t.style.pointerEvents="none"}}},8804:function(t){"use strict";t.exports=function(t,e){for(var n in e)t[n]=e[n];return t}},5135:function(t,e,n){"use strict";var r="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:null;t.exports=r},6056:function(t){"use strict";t.exports=function(){for(var t=0,e=0;e<arguments.length;e++){var n=arguments[e];t+=n+(n<<10),t^=n>>6}return t+=t<<3,t^=t>>11,(t+=t<<15)>=0?t:-t}},5003:function(t){"use strict";t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},2533:function(t){"use strict";t.exports=function(t){return(t&t-1)==0}},8001:function(t){"use strict";t.exports=function(t,e){return(+t%(e=+e)+e)%e}},3120:function(t){"use strict";t.exports=function(){}},1227:function(t){"use strict";t.exports="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()}},827:function(t){"use strict";t.exports=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}}},2468:function(t){"use strict";t.exports=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t&&t.deviceXDPI&&t.logicalXDPI)return t.deviceXDPI/t.logicalXDPI;if(t&&t.systemXDPI&&t.logicalXDPI)return t.systemXDPI/t.logicalXDPI}return 1}},7691:function(t,e,n){"use strict";var r=n(6939).setTransform,i=n(4743);t.exports=function(t,e,n,o){o=o||"",r(t,"translateX("+i(e)+"px) translateY("+i(n)+"px) translateZ(0) "+o)}},910:function(t){"use strict";t.exports=function(t){return 180*t/Math.PI}},6467:function(t){"use strict";t.exports=function(t){return"number"==typeof t&&isFinite(t)}},2582:function(t,e,n){"use strict";var r=n(3120);t.exports=function(t){return function(){var e=arguments.length?Array.prototype.slice.call(arguments,0,arguments.length-1):[],n=arguments.length?arguments[arguments.length-1]:r,i=null,o=!1;function s(){var r=arguments[0];!r||o?n.apply(null,arguments):i=t.apply(null,e)}return e.push(s),s(!0),function(){o=!0,i.apply(null,arguments)}}}},5026:function(t,e,n){"use strict";var r=n(1227);t.exports=function(t,e,n){var i=!1,o=r();return e(0),requestAnimationFrame(function s(){if(!i){var a=(r()-o)/t;a<1?(e(a),requestAnimationFrame(s)):(e(1),n())}}),function(){i=!0,n.apply(null,arguments)}}},3969:function(t){"use strict";t.exports=function(t){var e=typeof t;if("object"===e){if(null===t)return"null";if("[object Array]"===Object.prototype.toString.call(t))return"array";if("[object RegExp]"===Object.prototype.toString.call(t))return"regexp"}return e}},8793:function(t,e,n){"use strict";var r=n(5696),i=n(5994).mat4,o=n(5994).vec4,s=n(2468),a=n(6467),h=n(5342),u=n(6112),c=[1,0,1,0],l=[-1,-1,1,1];function f(t,e){if(!(t&&null!=t.mediaAspectRatio))throw Error("mediaAspectRatio must be defined");this._x=t&&null!=t.x?t.x:.5,this._y=t&&null!=t.y?t.y:.5,this._zoom=t&&null!=t.zoom?t.zoom:1,this._mediaAspectRatio=t.mediaAspectRatio,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._limiter=e||null,this._projMatrix=i.create(),this._invProjMatrix=i.create(),this._frustum=[0,0,0,0],this._projectionChanged=!0,this._params={},this._vec=o.create(),this._update()}r(f),f.prototype.destroy=function(){u(this)},f.prototype.x=function(){return this._x},f.prototype.y=function(){return this._y},f.prototype.zoom=function(){return this._zoom},f.prototype.mediaAspectRatio=function(){return this._mediaAspectRatio},f.prototype.width=function(){return this._width},f.prototype.height=function(){return this._height},f.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},f.prototype.parameters=function(t){return(t=t||{}).x=this._x,t.y=this._y,t.zoom=this._zoom,t.mediaAspectRatio=this._mediaAspectRatio,t},f.prototype.limiter=function(){return this._limiter},f.prototype.setX=function(t){this._resetParams(),this._params.x=t,this._update(this._params)},f.prototype.setY=function(t){this._resetParams(),this._params.y=t,this._update(this._params)},f.prototype.setZoom=function(t){this._resetParams(),this._params.zoom=t,this._update(this._params)},f.prototype.offsetX=function(t){this.setX(this._x+t)},f.prototype.offsetY=function(t){this.setY(this._y+t)},f.prototype.offsetZoom=function(t){this.setZoom(this._zoom+t)},f.prototype.setMediaAspectRatio=function(t){this._resetParams(),this._params.mediaAspectRatio=t,this._update(this._params)},f.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},f.prototype.setParameters=function(t){this._resetParams(),this._params.x=t.x,this._params.y=t.y,this._params.zoom=t.zoom,this._params.mediaAspectRatio=t.mediaAspectRatio,this._update(this._params)},f.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},f.prototype._resetParams=function(){var t=this._params;t.x=null,t.y=null,t.zoom=null,t.mediaAspectRatio=null,t.width=null,t.height=null},f.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._x,n=this._y,r=this._zoom,i=this._mediaAspectRatio,o=this._width,s=this._height;if(t.x=null!=t.x?t.x:e,t.y=null!=t.y?t.y:n,t.zoom=null!=t.zoom?t.zoom:r,t.mediaAspectRatio=null!=t.mediaAspectRatio?t.mediaAspectRatio:i,t.width=null!=t.width?t.width:o,t.height=null!=t.height?t.height:s,this._limiter&&!(t=this._limiter(t)))throw Error("Bad view limiter");var u=t.x,c=t.y,l=t.zoom,f=t.mediaAspectRatio,p=t.width,d=t.height;if(!a(u)||!a(c)||!a(l)||!a(f)||!a(p)||!a(d))throw Error("Bad view - suspect a broken limiter");l=h(l,1e-6,1/0),this._x=u,this._y=c,this._zoom=l,this._mediaAspectRatio=f,this._width=p,this._height=d,(u!==e||c!==n||l!==r||f!==i||p!==o||d!==s)&&(this._projectionChanged=!0,this.emit("change")),(p!==o||d!==s)&&this.emit("resize")},f.prototype._zoomX=function(){return this._zoom},f.prototype._zoomY=function(){var t=this._mediaAspectRatio,e=this._width/this._height,n=this._zoom,r=n*t/e;return isNaN(r)&&(r=n),r},f.prototype.updateWithControlParameters=function(t){var e=this.zoom(),n=this._zoomX(),r=this._zoomY();this.offsetX(t.axisScaledX*n+t.x*e),this.offsetY(t.axisScaledY*r+t.y*e),this.offsetZoom(t.zoom*e)},f.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var r=this._x,o=this._y,s=this._zoomX(),a=this._zoomY(),h=n[0]=.5-o+.5*a,u=n[1]=r-.5+.5*s,c=n[2]=.5-o-.5*a,l=n[3]=r-.5-.5*s;i.ortho(t,l,u,c,h,-1,1),i.invert(e,t),this._projectionChanged=!1}},f.prototype.projection=function(){return this._updateProjection(),this._projMatrix},f.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},f.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=0;n<e.length;n++){for(var r=e[n],i=c[n],o=l[n],s=!1,a=0;a<t.length;a++){var h=t[a];if(o<0&&h[i]<r||o>0&&h[i]>r){s=!0;break}}if(!s)return!1}return!0},f.prototype.selectLevel=function(t){for(var e=s()*this.width(),n=this._zoom,r=0;r<t.length;r++){var i=t[r];if(n*i.width()>=e)return i}return t[t.length-1]},f.prototype.coordinatesToScreen=function(t,e){var n=this._vec;e||(e={});var r=this._width,i=this._height;if(r<=0||i<=0)return e.x=null,e.y=null,null;var s=t&&null!=t.x?t.x:.5,a=t&&null!=t.y?t.y:.5;o.set(n,s-.5,.5-a,-1,1),o.transformMat4(n,n,this.projection());for(var h=0;h<3;h++)n[h]/=n[3];return e.x=r*(n[0]+1)/2,e.y=i*(1-n[1])/2,e},f.prototype.screenToCoordinates=function(t,e){var n=this._vec;e||(e={});var r=this._width,i=this._height,s=2*t.x/r-1,a=1-2*t.y/i;return o.set(n,s,a,1,1),o.transformMat4(n,n,this.inverseProjection()),e.x=.5+n[0],e.y=.5-n[1],e},f.limit={x:function(t,e){return function(n){return n.x=h(n.x,t,e),n}},y:function(t,e){return function(n){return n.y=h(n.y,t,e),n}},zoom:function(t,e){return function(n){return n.zoom=h(n.zoom,t,e),n}},resolution:function(t){return function(e){if(e.width<=0||e.height<=0)return e;var n=e.width,r=s()*n/t;return e.zoom=h(e.zoom,r,1/0),e}},visibleX:function(t,e){return function(n){var r=e-t;n.zoom>r&&(n.zoom=r);var i=t+.5*n.zoom,o=e-.5*n.zoom;return n.x=h(n.x,i,o),n}},visibleY:function(t,e){return function(n){if(n.width<=0||n.height<=0)return n;var r=n.width/n.height/n.mediaAspectRatio,i=(e-t)*r;n.zoom>i&&(n.zoom=i);var o=t+.5*n.zoom/r,s=e-.5*n.zoom/r;return n.y=h(n.y,o,s),n}},letterbox:function(){return function(t){if(t.width<=0||t.height<=0)return t;var e,n,r,i,o=t.width/t.height,s=o/t.mediaAspectRatio;return t.mediaAspectRatio>=o&&(t.zoom=Math.min(t.zoom,1)),t.mediaAspectRatio<=o&&(t.zoom=Math.min(t.zoom,s)),t.zoom>1?e=n=.5:(e=0+.5*t.zoom/1,n=1-.5*t.zoom/1),t.zoom>s?r=i=.5:(r=0+.5*t.zoom/s,i=1-.5*t.zoom/s),t.x=h(t.x,e,n),t.y=h(t.y,r,i),t}}},f.type=f.prototype.type="flat",t.exports=f},3070:function(t,e,n){"use strict";var r=n(5696),i=n(5994).mat4,o=n(5994).vec4,s=n(2468),a=n(1745),h=n(8001),u=n(6467),c=n(5342),l=n(4743),f=n(6414),p=n(6112),d=Math.PI/4;function v(t,e){this._yaw=t&&null!=t.yaw?t.yaw:0,this._pitch=t&&null!=t.pitch?t.pitch:0,this._roll=t&&null!=t.roll?t.roll:0,this._fov=t&&null!=t.fov?t.fov:d,this._width=t&&null!=t.width?t.width:0,this._height=t&&null!=t.height?t.height:0,this._projectionCenterX=t&&null!=t.projectionCenterX?t.projectionCenterX:0,this._projectionCenterY=t&&null!=t.projectionCenterY?t.projectionCenterY:0,this._limiter=e||null,this._projMatrix=i.create(),this._invProjMatrix=i.create(),this._frustum=[o.create(),o.create(),o.create(),o.create(),o.create()],this._projectionChanged=!0,this._params={},this._fovs={},this._tmpVec=o.create(),this._update()}r(v),v.prototype.destroy=function(){p(this)},v.prototype.yaw=function(){return this._yaw},v.prototype.pitch=function(){return this._pitch},v.prototype.roll=function(){return this._roll},v.prototype.projectionCenterX=function(){return this._projectionCenterX},v.prototype.projectionCenterY=function(){return this._projectionCenterY},v.prototype.fov=function(){return this._fov},v.prototype.width=function(){return this._width},v.prototype.height=function(){return this._height},v.prototype.size=function(t){return(t=t||{}).width=this._width,t.height=this._height,t},v.prototype.parameters=function(t){return(t=t||{}).yaw=this._yaw,t.pitch=this._pitch,t.roll=this._roll,t.fov=this._fov,t},v.prototype.limiter=function(){return this._limiter},v.prototype.setYaw=function(t){this._resetParams(),this._params.yaw=t,this._update(this._params)},v.prototype.setPitch=function(t){this._resetParams(),this._params.pitch=t,this._update(this._params)},v.prototype.setRoll=function(t){this._resetParams(),this._params.roll=t,this._update(this._params)},v.prototype.setFov=function(t){this._resetParams(),this._params.fov=t,this._update(this._params)},v.prototype.setProjectionCenterX=function(t){this._resetParams(),this._params.projectionCenterX=t,this._update(this._params)},v.prototype.setProjectionCenterY=function(t){this._resetParams(),this._params.projectionCenterY=t,this._update(this._params)},v.prototype.offsetYaw=function(t){this.setYaw(this._yaw+t)},v.prototype.offsetPitch=function(t){this.setPitch(this._pitch+t)},v.prototype.offsetRoll=function(t){this.setRoll(this._roll+t)},v.prototype.offsetFov=function(t){this.setFov(this._fov+t)},v.prototype.setSize=function(t){this._resetParams(),this._params.width=t.width,this._params.height=t.height,this._update(this._params)},v.prototype.setParameters=function(t){this._resetParams(),this._params.yaw=t.yaw,this._params.pitch=t.pitch,this._params.roll=t.roll,this._params.fov=t.fov,this._params.projectionCenterX=t.projectionCenterX,this._params.projectionCenterY=t.projectionCenterY,this._update(this._params)},v.prototype.setLimiter=function(t){this._limiter=t||null,this._update()},v.prototype._resetParams=function(){var t=this._params;t.yaw=null,t.pitch=null,t.roll=null,t.fov=null,t.width=null,t.height=null},v.prototype._update=function(t){null==t&&(this._resetParams(),t=this._params);var e=this._yaw,n=this._pitch,r=this._roll,i=this._fov,o=this._projectionCenterX,s=this._projectionCenterY,a=this._width,h=this._height;if(t.yaw=null!=t.yaw?t.yaw:e,t.pitch=null!=t.pitch?t.pitch:n,t.roll=null!=t.roll?t.roll:r,t.fov=null!=t.fov?t.fov:i,t.width=null!=t.width?t.width:a,t.height=null!=t.height?t.height:h,t.projectionCenterX=null!=t.projectionCenterX?t.projectionCenterX:o,t.projectionCenterY=null!=t.projectionCenterY?t.projectionCenterY:s,this._limiter&&!(t=this._limiter(t)))throw Error("Bad view limiter");var c=(t=this._normalize(t)).yaw,l=t.pitch,f=t.roll,p=t.fov,d=t.width,v=t.height,m=t.projectionCenterX,_=t.projectionCenterY;if(!u(c)||!u(l)||!u(f)||!u(p)||!u(d)||!u(v)||!u(m)||!u(_))throw Error("Bad view - suspect a broken limiter");this._yaw=c,this._pitch=l,this._roll=f,this._fov=p,this._width=d,this._height=v,this._projectionCenterX=m,this._projectionCenterY=_,(c!==e||l!==n||f!==r||p!==i||d!==a||v!==h||m!==o||_!==s)&&(this._projectionChanged=!0,this.emit("change")),(d!==a||v!==h)&&this.emit("resize")},v.prototype._normalize=function(t){this._normalizeCoordinates(t);var e=a.htov(Math.PI,t.width,t.height),n=isNaN(e)?Math.PI:Math.min(Math.PI,e);return t.fov=c(t.fov,1e-6,n-1e-6),t},v.prototype._normalizeCoordinates=function(t){return"yaw"in t&&(t.yaw=h(t.yaw-Math.PI,-2*Math.PI)+Math.PI),"pitch"in t&&(t.pitch=h(t.pitch-Math.PI,-2*Math.PI)+Math.PI),"roll"in t&&(t.roll=h(t.roll-Math.PI,-2*Math.PI)+Math.PI),t},v.prototype.normalizeToClosest=function(t,e){var n=this._yaw,r=this._pitch,i=t.yaw,o=t.pitch,s=i-2*Math.PI,a=i+2*Math.PI;Math.abs(s-n)<Math.abs(i-n)?i=s:Math.abs(a-n)<Math.abs(i-n)&&(i=a);var h=o-2*Math.PI,u=o+2*Math.PI;return Math.abs(h-r)<Math.abs(o-r)?o=h:Math.abs(h-r)<Math.abs(o-r)&&(o=u),(e=e||{}).yaw=i,e.pitch=o,e},v.prototype.updateWithControlParameters=function(t){var e=this._fov,n=a.vtoh(e,this._width,this._height);isNaN(n)&&(n=e),this.offsetYaw(t.axisScaledX*n+2*t.x*n+t.yaw),this.offsetPitch(t.axisScaledY*e+2*t.y*n+t.pitch),this.offsetRoll(-t.roll),this.offsetFov(t.zoom*e)},v.prototype._updateProjection=function(){var t=this._projMatrix,e=this._invProjMatrix,n=this._frustum;if(this._projectionChanged){var r=this._width,o=this._height,s=this._fov,h=a.vtoh(s,r,o),u=this._projectionCenterX,c=this._projectionCenterY;if(0!==u||0!==c){var l=Math.atan(2*u*Math.tan(h/2)),f=Math.atan(2*c*Math.tan(s/2)),p=this._fovs;p.leftDegrees=(h/2+l)*180/Math.PI,p.rightDegrees=(h/2-l)*180/Math.PI,p.upDegrees=(s/2+f)*180/Math.PI,p.downDegrees=(s/2-f)*180/Math.PI,i.perspectiveFromFieldOfView(t,p,-1,1)}else i.perspective(t,s,r/o,-1,1);i.rotateZ(t,t,this._roll),i.rotateX(t,t,this._pitch),i.rotateY(t,t,this._yaw),i.invert(e,t),this._matrixToFrustum(t,n),this._projectionChanged=!1}},v.prototype._matrixToFrustum=function(t,e){o.set(e[0],t[3]+t[0],t[7]+t[4],t[11]+t[8],0),o.set(e[1],t[3]-t[0],t[7]-t[4],t[11]-t[8],0),o.set(e[2],t[3]+t[1],t[7]+t[5],t[11]+t[9],0),o.set(e[3],t[3]-t[1],t[7]-t[5],t[11]-t[9],0),o.set(e[4],t[3]+t[2],t[7]+t[6],t[11]+t[10],0)},v.prototype.projection=function(){return this._updateProjection(),this._projMatrix},v.prototype.inverseProjection=function(){return this._updateProjection(),this._invProjMatrix},v.prototype.intersects=function(t){this._updateProjection();for(var e=this._frustum,n=this._tmpVec,r=0;r<e.length;r++){for(var i=e[r],s=!1,a=0;a<t.length;a++){var h=t[a];o.set(n,h[0],h[1],h[2],0),o.dot(i,n)>=0&&(s=!0)}if(!s)return!1}return!0},v.prototype.selectLevel=function(t){for(var e=s()*this._height,n=Math.tan(.5*this._fov),r=0;r<t.length;r++){var i=t[r];if(n*i.height()>=e)return i}return t[t.length-1]},v.prototype.coordinatesToScreen=function(t,e){var n=this._tmpVec;e||(e={});var r=this._width,i=this._height;if(r<=0||i<=0)return e.x=null,e.y=null,null;var s=t.yaw,a=t.pitch,h=Math.sin(s)*Math.cos(a),u=-Math.sin(a),c=-Math.cos(s)*Math.cos(a);return(o.set(n,h,u,c,1),o.transformMat4(n,n,this.projection()),n[3]>=0)?(e.x=r*(n[0]/n[3]+1)/2,e.y=i*(1-n[1]/n[3])/2,e):(e.x=null,e.y=null,null)},v.prototype.screenToCoordinates=function(t,e){var n=this._tmpVec;e||(e={});var r=this._width,i=this._height,s=2*t.x/r-1,a=1-2*t.y/i;o.set(n,s,a,1,1),o.transformMat4(n,n,this.inverseProjection());var h=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return e.yaw=Math.atan2(n[0],-n[2]),e.pitch=Math.acos(n[1]/h)-Math.PI/2,this._normalizeCoordinates(e),e},v.prototype.coordinatesToPerspectiveTransform=function(t,e,n){n=n||"";var r=this._height,i=this._width,o=.5*r/Math.tan(this._fov/2);return"translateX("+l(i/2)+"px) translateY("+l(r/2)+"px) translateX(-50%) translateY(-50%) perspective("+l(o)+"px) translateZ("+l(o)+"px) rotateZ("+l(-this._roll)+"rad) rotateX("+l(-this._pitch)+"rad) rotateY("+l(this._yaw)+"rad) rotateY("+l(-t.yaw)+"rad) rotateX("+l(t.pitch)+"rad) translateZ("+l(-e)+"px) "+n+" "},v.limit={yaw:function(t,e){return function(n){return n.yaw=c(n.yaw,t,e),n}},pitch:function(t,e){return function(n){return n.pitch=c(n.pitch,t,e),n}},roll:function(t,e){return function(n){return n.roll=c(n.roll,t,e),n}},hfov:function(t,e){return function(n){var r=n.width,i=n.height;if(r>0&&i>0){var o=a.htov(t,r,i),s=a.htov(e,r,i);n.fov=c(n.fov,o,s)}return n}},vfov:function(t,e){return function(n){return n.fov=c(n.fov,t,e),n}},resolution:function(t){return function(e){var n=e.height;if(n){var r=2*Math.atan(s()*n/t);e.fov=c(e.fov,r,1/0)}return e}},traditional:function(t,e,n){return n=null!=n?n:e,f(v.limit.resolution(t),v.limit.vfov(0,e),v.limit.hfov(0,n),v.limit.pitch(-Math.PI/2,Math.PI/2))}},v.type=v.prototype.type="rectilinear",t.exports=v},5696:function(t){"use strict";function e(){}e.prototype.addEventListener=function(t,e){var n=this.__events=this.__events||{},r=n[t]=n[t]||[];0>r.indexOf(e)&&r.push(e)},e.prototype.removeEventListener=function(t,e){var n=(this.__events=this.__events||{})[t];if(n){var r=n.indexOf(e);r>=0&&n.splice(r,1)}},e.prototype.emit=function(t,e){var n=(this.__events=this.__events||{})[t],r=Array.prototype.slice.call(arguments,1);if(n)for(var i=0;i<n.length;i++)n[i].apply(this,r)},t.exports=function(t){for(var n in e.prototype)e.prototype.hasOwnProperty(n)&&(t.prototype[n]=e.prototype[n])}}}]);